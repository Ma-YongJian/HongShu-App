{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/SocketTask.ts","webpack:///./src/event.ts","webpack:///./src/html/index.html","webpack:///./src/index.ts","webpack:///./src/inject/webSocket.str.js","webpack:///./src/lib/base64-arraybuffer.ts","webpack:///./src/utils.ts","webpack:///./src/webSocket.ts"],"names":["__createBinding","Object","create","o","m","k","k2","undefined","defineProperty","enumerable","get","__setModuleDefault","v","value","__importStar","mod","__esModule","result","hasOwnProperty","call","__importDefault","exports","SocketTask","$event","require","utils_1","base64_arraybuffer_1","WEBVIEW_ID","webSocketInjected","callbacks","webSocket","_webviewReady","_webviewReadyCallbacks","timer","webviewReady","callback","webview","plus","getWebviewById","html","kernel","render","plusrequire","overrideUrlLoading","match","event","url","console","log","data","action","detail","JSON","parse","decodeURIComponent","emit","type","callbackName","error","indexOf","setInterval","evalJS","clearInterval","forEach","loadData","baseURL","push","id","Date","now","toString","eval","encode","on","decode","method","cbs","isWeb","window","js","stringify","plusReady","eventName","off","addEventListener","removeEventListener","splice","document","dispatchEvent","CustomEvent","bubbles","cb","webSocket_1","connectSocket","onSocketOpen","onSocketError","sendSocketMessage","onSocketMessage","closeSocket","onSocketClose","Base64","chars","lookup","arraybuffer","bytes","Uint8Array","i","len","length","base64","substring","charCodeAt","bufferLength","p","encoded1","encoded2","encoded3","encoded4","ArrayBuffer","getCallback","isApp","isWeex","isPlus","navigator","userAgent","weex","successData","failData","errMsg","message","String","success","warn","fail","complete","SocketTask_1","globalSocketTask","globalEvents","socketTask","clear","onClose","onError","send","close"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.ts\");\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SocketTask = void 0;\nconst $event = __importStar(require(\"./event\"));\nconst utils_1 = require(\"./utils\");\nconst base64_arraybuffer_1 = __importDefault(require(\"./lib/base64-arraybuffer\"));\nconst WEBVIEW_ID = '__websocket__';\nvar webSocketInjected;\nvar callbacks = {};\nvar webSocket = require('./inject/webSocket.str.js');\nvar _webviewReady = false;\nvar _webviewReadyCallbacks = [];\nvar timer;\nfunction webviewReady(callback) {\n    var webview = plus.webview.getWebviewById(WEBVIEW_ID);\n    if (!webview) {\n        let html = require('./html/index.html');\n        webview = plus.webview.create('http://www.dcloud.io', WEBVIEW_ID, {\n            kernel: 'UIWebview',\n            render: 'always',\n            plusrequire: 'none'\n        });\n        webview.overrideUrlLoading({\n            match: '.*data.*'\n        }, (event) => {\n            const url = event.url;\n            console.log(url);\n            var data = url.match(/\\?(\\S+)=(\\S+)/);\n            if (data) {\n                let action = data[1];\n                let detail = JSON.parse(decodeURIComponent(data[2]));\n                if (action === 'event') {\n                    $event.emit(detail.type, detail.data);\n                }\n                else if (action === 'callback') {\n                    callbacks[detail.callbackName](detail.error);\n                }\n            }\n            else if (!_webviewReady && typeof timer !== 'number' && url.indexOf('load') >= 0) {\n                timer = setInterval(() => {\n                    webview.evalJS(webSocket);\n                }, 16);\n            }\n            else if (!_webviewReady && url.indexOf('ready') >= 0) {\n                clearInterval(timer);\n                _webviewReady = true;\n                _webviewReadyCallbacks.forEach(callback => {\n                    callback(webview);\n                });\n                _webviewReadyCallbacks = [];\n            }\n        });\n        webview.loadData(html, {\n            baseURL: 'http://websocket.websocket'\n        });\n    }\n    if (_webviewReady) {\n        callback(webview);\n    }\n    else {\n        _webviewReadyCallbacks.push(callback);\n    }\n}\nclass SocketTask {\n    constructor(data) {\n        this.id = Date.now().toString();\n        this.eval('connect', data);\n    }\n    send(data) {\n        if (data.data && typeof data.data !== 'string') {\n            data.data = [base64_arraybuffer_1.default.encode(data.data)];\n        }\n        this.eval('send', data);\n    }\n    close(data) {\n        this.eval('close', data);\n    }\n    onOpen(callback) {\n        this.on('open', callback);\n    }\n    onClose(callback) {\n        this.on('close', callback);\n    }\n    onError(callback) {\n        this.on('error', callback);\n    }\n    onMessage(callback) {\n        this.on('message', (data) => {\n            data = data.data;\n            data = data && typeof data !== 'string' ? base64_arraybuffer_1.default.decode(data[0]) : data;\n            callback({ data });\n        });\n    }\n    eval(method, data) {\n        var callbackName = `callback${Date.now()}`;\n        var cbs = utils_1.isWeb ? window : callbacks;\n        cbs[callbackName] = (error) => {\n            delete cbs[callbackName];\n            if (error) {\n                utils_1.callback(data, {}, error);\n            }\n            else {\n                utils_1.callback(data, {});\n            }\n        };\n        var js = `window.__webSocket&&__webSocket.${method}(${this.id},${JSON.stringify(data)},'${callbackName}')`;\n        if (utils_1.isWeb) {\n            if (!webSocketInjected) {\n                window.eval(webSocket);\n                webSocketInjected = true;\n            }\n            window.eval(js);\n        }\n        else {\n            utils_1.plusReady(() => {\n                webviewReady((webview) => {\n                    webview.evalJS(js);\n                });\n            });\n        }\n    }\n    on(eventName, callback) {\n        $event.on(`websocket${eventName}${this.id}`, (event) => {\n            callback(event.detail);\n        });\n    }\n}\nexports.SocketTask = SocketTask;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.emit = exports.off = exports.on = void 0;\nconst utils_1 = require(\"./utils\");\nconst callbacks = {};\nfunction on(type, callback) {\n    if (utils_1.isWeb) {\n        window.addEventListener(type, callback, false);\n    }\n    else {\n        callbacks[type] = callbacks[type] || [];\n        callbacks[type].push(callback);\n    }\n}\nexports.on = on;\nfunction off(type, callback) {\n    if (utils_1.isWeb) {\n        window.removeEventListener(type, callback, false);\n    }\n    else {\n        let cbs = callbacks[type];\n        if (cbs) {\n            cbs.splice(cbs.indexOf(callback), 1);\n        }\n    }\n}\nexports.off = off;\nfunction emit(type, data) {\n    if (utils_1.isWeb) {\n        document.dispatchEvent(new CustomEvent(type, {\n            detail: data,\n            bubbles: true\n        }));\n    }\n    else {\n        let cbs = callbacks[type];\n        cbs && cbs.forEach(cb => {\n            cb({\n                detail: data\n            });\n        });\n    }\n}\nexports.emit = emit;\n","module.exports = \"<!doctype html> <html lang=en> <head> <meta charset=UTF-8> <title>WebSocket</title> </head> <body> <script>location.href=\\\"http://data/load\\\"</script> </body> </html>\";","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar webSocket_1 = require(\"./webSocket\");\nObject.defineProperty(exports, \"connectSocket\", { enumerable: true, get: function () { return webSocket_1.connectSocket; } });\nObject.defineProperty(exports, \"onSocketOpen\", { enumerable: true, get: function () { return webSocket_1.onSocketOpen; } });\nObject.defineProperty(exports, \"onSocketError\", { enumerable: true, get: function () { return webSocket_1.onSocketError; } });\nObject.defineProperty(exports, \"sendSocketMessage\", { enumerable: true, get: function () { return webSocket_1.sendSocketMessage; } });\nObject.defineProperty(exports, \"onSocketMessage\", { enumerable: true, get: function () { return webSocket_1.onSocketMessage; } });\nObject.defineProperty(exports, \"closeSocket\", { enumerable: true, get: function () { return webSocket_1.closeSocket; } });\nObject.defineProperty(exports, \"onSocketClose\", { enumerable: true, get: function () { return webSocket_1.onSocketClose; } });\n","module.exports = \"(function () {\\n    if (window.__webSocket) {\\n        return\\n    }\\n    var isPlus = typeof navigator === 'object' && !!navigator.userAgent.match(/Html5Plus/i)\\n    if (isPlus) {\\n        location.href = 'http://data?ready'\\n    }\\n    // 自定义事件\\n    var $event = {\\n        emit (type, data) {\\n            if (!isPlus) {\\n                document.dispatchEvent(new CustomEvent(type, {\\n                    detail: data,\\n                    bubbles: true\\n                }))\\n                return\\n            }\\n            location.href = 'http://data?event=' + encodeURIComponent(JSON.stringify({\\n                type,\\n                data\\n            }))\\n        }\\n    }\\n    var Base64 = {\\n        chars: \\\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\\\",\\n        lookup: null,\\n        encode: function (arraybuffer) {\\n            var chars = this.chars;\\n            var bytes = new Uint8Array(arraybuffer),\\n                i, len = bytes.length, base64 = \\\"\\\";\\n\\n            for (i = 0; i < len; i += 3) {\\n                base64 += chars[bytes[i] >> 2];\\n                base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\\n                base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\\n                base64 += chars[bytes[i + 2] & 63];\\n            }\\n\\n            if ((len % 3) === 2) {\\n                base64 = base64.substring(0, base64.length - 1) + \\\"=\\\";\\n            } else if (len % 3 === 1) {\\n                base64 = base64.substring(0, base64.length - 2) + \\\"==\\\";\\n            }\\n\\n            return base64;\\n        },\\n        decode: function (base64) {\\n            var chars = this.chars;\\n            var lookup = this.lookup\\n            if (!lookup) {\\n                lookup = this.lookup = new Uint8Array(256);\\n                for (var i = 0; i < chars.length; i++) {\\n                    lookup[chars.charCodeAt(i)] = i;\\n                }\\n            }\\n            var bufferLength = base64.length * 0.75,\\n                len = base64.length, p = 0,\\n                encoded1, encoded2, encoded3, encoded4;\\n\\n            if (base64[base64.length - 1] === \\\"=\\\") {\\n                bufferLength--;\\n                if (base64[base64.length - 2] === \\\"=\\\") {\\n                    bufferLength--;\\n                }\\n            }\\n\\n            var arraybuffer = new ArrayBuffer(bufferLength),\\n                bytes = new Uint8Array(arraybuffer);\\n\\n            for (i = 0; i < len; i += 4) {\\n                encoded1 = lookup[base64.charCodeAt(i)];\\n                encoded2 = lookup[base64.charCodeAt(i + 1)];\\n                encoded3 = lookup[base64.charCodeAt(i + 2)];\\n                encoded4 = lookup[base64.charCodeAt(i + 3)];\\n\\n                bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\\n                bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\\n                bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\\n            }\\n\\n            return arraybuffer;\\n        }\\n    }\\n\\n    window.__webSocket = {\\n        webSockets: {},\\n        connect (id, data, callbackName) {\\n            var url = data.url\\n            var header = data.header// 未支持\\n            var method = data.method// 未支持\\n            var protocols = data.protocols || []\\n            var webSocket\\n            try {\\n                webSocket = this.webSockets[id] = new WebSocket(url, protocols)\\n                webSocket.binaryType = 'arraybuffer'\\n            } catch (error) {\\n                this.callback(callbackName, error)\\n                return\\n            }\\n            this.callback(callbackName)\\n            if (webSocket) {\\n                webSocket.addEventListener('open', () => {\\n                    $event.emit(`websocketopen${id}`, {})\\n                })\\n                webSocket.addEventListener('message', ({ data }) => {\\n                    $event.emit(`websocketmessage${id}`, {\\n                        data: data && typeof data !== 'string' ? [Base64.encode(data)] : data\\n                    })\\n                })\\n                webSocket.addEventListener('error', () => {\\n                    $event.emit(`websocketerror${id}`, {})\\n                })\\n                webSocket.addEventListener('close', () => {\\n                    $event.emit(`websocketclose${id}`, {})\\n                })\\n            }\\n        },\\n        send (id, data = {}, callbackName) {\\n            data = data.data\\n            data = data && typeof data !== 'string' ? Base64.decode(data[0]) : data\\n            try {\\n                this.webSockets[id].send(data)\\n            } catch (error) {\\n                this.callback(callbackName, error)\\n                return\\n            }\\n            this.callback(callbackName)\\n        },\\n        close (id, data = {}, callbackName) {\\n            var options = []\\n            options.push(data.code || 1000)\\n            if (typeof data.reason === 'string') {\\n                options.push(data.reason)\\n            }\\n            try {\\n                this.webSockets[id].close(...options)\\n            } catch (error) {\\n                this.callback(callbackName, error)\\n                return\\n            }\\n            this.callback(callbackName)\\n        },\\n        callback (callbackName, error) {\\n            if (isPlus) {\\n                location.href = 'http://data?callback=' + encodeURIComponent(JSON.stringify({\\n                    callbackName,\\n                    error\\n                }))\\n            } else {\\n                var js = `window.${callbackName}&&window.${callbackName}('${error || ''}')`\\n                window[callbackName] && window[callbackName](error | '')\\n                window.eval(js)\\n            }\\n        }\\n    }\\n})()\";","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Base64 = {\n    chars: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",\n    lookup: null,\n    encode: function (arraybuffer) {\n        var chars = this.chars;\n        var bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = \"\";\n        for (i = 0; i < len; i += 3) {\n            base64 += chars[bytes[i] >> 2];\n            base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n            base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n            base64 += chars[bytes[i + 2] & 63];\n        }\n        if ((len % 3) === 2) {\n            base64 = base64.substring(0, base64.length - 1) + \"=\";\n        }\n        else if (len % 3 === 1) {\n            base64 = base64.substring(0, base64.length - 2) + \"==\";\n        }\n        return base64;\n    },\n    decode: function (base64) {\n        var chars = this.chars;\n        var lookup = this.lookup;\n        if (!lookup) {\n            lookup = this.lookup = new Uint8Array(256);\n            for (var i = 0; i < chars.length; i++) {\n                lookup[chars.charCodeAt(i)] = i;\n            }\n        }\n        var bufferLength = base64.length * 0.75, len = base64.length, p = 0, encoded1, encoded2, encoded3, encoded4;\n        if (base64[base64.length - 1] === \"=\") {\n            bufferLength--;\n            if (base64[base64.length - 2] === \"=\") {\n                bufferLength--;\n            }\n        }\n        var arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n        for (i = 0; i < len; i += 4) {\n            encoded1 = lookup[base64.charCodeAt(i)];\n            encoded2 = lookup[base64.charCodeAt(i + 1)];\n            encoded3 = lookup[base64.charCodeAt(i + 2)];\n            encoded4 = lookup[base64.charCodeAt(i + 3)];\n            bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n            bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n            bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n        }\n        return arraybuffer;\n    }\n};\nexports.default = Base64;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getCallback = exports.callback = exports.plusReady = exports.isApp = exports.isWeex = exports.isWeb = exports.isPlus = void 0;\nexports.isPlus = typeof navigator === 'object' && !!navigator.userAgent.match(/Html5Plus/i);\nexports.isWeb = typeof document === 'object' && !exports.isPlus;\nexports.isWeex = typeof weex === 'object';\nexports.isApp = exports.isPlus || exports.isWeex;\nfunction plusReady(cb) {\n    if (typeof plus === 'object') {\n        cb();\n    }\n    else if (exports.isApp) {\n        window.addEventListener('plusready', cb, false);\n    }\n}\nexports.plusReady = plusReady;\nfunction callback(data, successData, failData) {\n    if (successData) {\n        if (!successData.errMsg) {\n            successData.errMsg = 'callback:ok';\n        }\n    }\n    else {\n        if (typeof failData === 'object') {\n            if (!failData) {\n                failData = {\n                    errMsg: 'callback:fail'\n                };\n            }\n            if (!failData.errMsg) {\n                failData.errMsg = failData.message || 'callback:fail';\n            }\n        }\n        else {\n            failData = {\n                errMsg: 'callback:fail ' + String(failData)\n            };\n        }\n    }\n    if (data && typeof data.success === 'function' && successData) {\n        data.success(successData);\n    }\n    if (failData) {\n        console.warn('Callback Fail:', failData);\n    }\n    if (data && typeof data.fail === 'function' && failData) {\n        data.fail(failData);\n    }\n    if (data && typeof data.complete === 'function') {\n        data.complete(successData || failData);\n    }\n}\nexports.callback = callback;\nfunction getCallback() {\n    return callback;\n}\nexports.getCallback = getCallback;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.onSocketClose = exports.closeSocket = exports.onSocketMessage = exports.sendSocketMessage = exports.onSocketError = exports.onSocketOpen = exports.connectSocket = void 0;\nconst SocketTask_1 = require(\"./SocketTask\");\nvar globalSocketTask = null;\nvar globalEvents = {};\nfunction connectSocket(data) {\n    data = data || {};\n    var socketTask = new SocketTask_1.SocketTask(data);\n    function clear() {\n        globalSocketTask = null;\n    }\n    socketTask.onClose(clear);\n    socketTask.onError(clear);\n    if (!globalSocketTask) {\n        globalSocketTask = socketTask;\n        for (const event in globalEvents) {\n            if (globalEvents.hasOwnProperty(event)) {\n                socketTask[event](globalEvents[event]);\n            }\n        }\n    }\n    globalSocketTask = globalSocketTask || socketTask;\n    return socketTask;\n}\nexports.connectSocket = connectSocket;\nfunction on(event, cb) {\n    if (globalSocketTask) {\n        globalSocketTask[event](cb);\n    }\n    else {\n        globalEvents[event] = cb;\n    }\n}\nfunction onSocketOpen(cb) {\n    on('onOpen', cb);\n}\nexports.onSocketOpen = onSocketOpen;\nfunction onSocketError(cb) {\n    on('onError', cb);\n}\nexports.onSocketError = onSocketError;\nfunction sendSocketMessage(data) {\n    if (globalSocketTask) {\n        globalSocketTask.send(data);\n    }\n}\nexports.sendSocketMessage = sendSocketMessage;\nfunction onSocketMessage(cb) {\n    on('onMessage', cb);\n}\nexports.onSocketMessage = onSocketMessage;\nfunction closeSocket(data) {\n    if (globalSocketTask) {\n        globalSocketTask.close(data);\n    }\n}\nexports.closeSocket = closeSocket;\nfunction onSocketClose(cb) {\n    on('onClose', cb);\n}\nexports.onSocketClose = onSocketClose;\n"],"sourceRoot":""}