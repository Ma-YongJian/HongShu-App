(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-chat-chat"],{"077a":function(e,t,o){"use strict";o("6a54");var r=o("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,o("7a76"),o("c9b5");var n=r(o("fcf3")),i=r(o("80b1")),a=r(o("efe5")),s=r(o("39d8")),u=o("21a9"),l=o("ea125"),d=function(){function e(t){if((0,i.default)(this,e),(0,s.default)(this,"engine",void 0),!t)throw new Error("Can not be use new.");this.engine=t}return(0,a.default)(e,[{key:"destroy",value:function(){l.ZIMManager.getInstance().destroyEngine(this.engine),this.engine=null,e._instatance=null}},{key:"on",value:function(e,t){this.engine.on(e,t)}},{key:"off",value:function(e){this.engine.off(e)}},{key:"uploadLog",value:function(){return this.engine.uploadLog()}},{key:"login",value:function(e,t){return this.engine.login(e,t)}},{key:"logout",value:function(){return this.engine.logout()}},{key:"renewToken",value:function(e){return this.engine.renewToken(e)}},{key:"updateUserName",value:function(e){return this.engine.updateUserName(e)}},{key:"updateUserAvatarUrl",value:function(e){return this.engine.updateUserAvatarUrl(e)}},{key:"updateUserExtendedData",value:function(e){return this.engine.updateUserExtendedData(e)}},{key:"queryUsersInfo",value:function(e,t){return this.engine.queryUsersInfo(e,t)}},{key:"queryConversationList",value:function(e){return this.engine.queryConversationList(e)}},{key:"deleteConversation",value:function(e,t,o){return this.engine.deleteConversation(e,t,o)}},{key:"setConversationNotificationStatus",value:function(e,t,o){return this.engine.setConversationNotificationStatus(e,t,o)}},{key:"clearConversationUnreadMessageCount",value:function(e,t){return this.engine.clearConversationUnreadMessageCount(e,t)}},{key:"sendMessage",value:function(e,t,o,r,n){return this.engine.sendMessage(e,t,o,r,n)}},{key:"sendPeerMessage",value:function(e,t,o){return this.engine.sendMessage(e,t,u.ZIMConversationType.Peer,o)}},{key:"sendGroupMessage",value:function(e,t,o){return this.engine.sendMessage(e,t,u.ZIMConversationType.Group,o)}},{key:"sendRoomMessage",value:function(e,t,o){return this.engine.sendMessage(e,t,u.ZIMConversationType.Room,o)}},{key:"sendMediaMessage",value:function(e,t,o,r,n){return this.engine.sendMediaMessage(e,t,o,r,n)}},{key:"deleteMessages",value:function(e,t,o,r){return this.engine.deleteMessages(e,t,o,r)}},{key:"deleteAllMessage",value:function(e,t,o){return this.engine.deleteAllMessage(e,t,o)}},{key:"queryHistoryMessage",value:function(e,t,o){return this.engine.queryHistoryMessage(e,t,o)}},{key:"insertMessageToLocalDB",value:function(e,t,o,r){return this.engine.insertMessageToLocalDB(e,t,o,r)}},{key:"downloadMediaFile",value:function(e,t,o){return this.engine.downloadMediaFile(e,t,o)}},{key:"createRoom",value:function(e,t){return this.engine.createRoom(e,t)}},{key:"enterRoom",value:function(e,t){return this.engine.enterRoom(e,t)}},{key:"joinRoom",value:function(e){return this.engine.joinRoom(e)}},{key:"leaveRoom",value:function(e){return this.engine.leaveRoom(e)}},{key:"queryRoomMemberList",value:function(e,t){return this.engine.queryRoomMemberList(e,t)}},{key:"queryRoomOnlineMemberCount",value:function(e){return this.engine.queryRoomOnlineMemberCount(e)}},{key:"queryRoomAllAttributes",value:function(e){return this.engine.queryRoomAllAttributes(e)}},{key:"setRoomAttributes",value:function(e,t,o){return this.engine.setRoomAttributes(e,t,o)}},{key:"deleteRoomAttributes",value:function(e,t,o){return this.engine.deleteRoomAttributes(e,t,o)}},{key:"beginRoomAttributesBatchOperation",value:function(e,t){this.engine.beginRoomAttributesBatchOperation(e,t)}},{key:"endRoomAttributesBatchOperation",value:function(e){return this.engine.endRoomAttributesBatchOperation(e)}},{key:"setRoomMembersAttributes",value:function(e,t,o,r){return this.engine.setRoomMembersAttributes(e,t,o,r)}},{key:"queryRoomMembersAttributes",value:function(e,t){return this.engine.queryRoomMembersAttributes(e,t)}},{key:"queryRoomMemberAttributesList",value:function(e,t){return this.engine.queryRoomMemberAttributesList(e,t)}},{key:"createGroup",value:function(e,t,o){return this.engine.createGroup(e,t,o)}},{key:"joinGroup",value:function(e){return this.engine.joinGroup(e)}},{key:"leaveGroup",value:function(e){return this.engine.leaveGroup(e)}},{key:"dismissGroup",value:function(e){return this.engine.dismissGroup(e)}},{key:"queryGroupList",value:function(){return this.engine.queryGroupList()}},{key:"updateGroupNotice",value:function(e,t){return this.engine.updateGroupNotice(e,t)}},{key:"updateGroupName",value:function(e,t){return this.engine.updateGroupName(e,t)}},{key:"updateGroupAvatarUrl",value:function(e,t){return this.engine.updateGroupAvatarUrl(e,t)}},{key:"queryGroupInfo",value:function(e){return this.engine.queryGroupInfo(e)}},{key:"setGroupAttributes",value:function(e,t){return this.engine.setGroupAttributes(e,t)}},{key:"deleteGroupAttributes",value:function(e,t){return this.engine.deleteGroupAttributes(e,t)}},{key:"queryGroupAttributes",value:function(e,t){return this.engine.queryGroupAttributes(e,t)}},{key:"queryGroupAllAttributes",value:function(e){return this.engine.queryGroupAllAttributes(e)}},{key:"setGroupMemberNickname",value:function(e,t,o){return this.engine.setGroupMemberNickname(e,t,o)}},{key:"setGroupMemberRole",value:function(e,t,o){return this.engine.setGroupMemberRole(e,t,o)}},{key:"transferGroupOwner",value:function(e,t){return this.engine.transferGroupOwner(e,t)}},{key:"queryGroupMemberInfo",value:function(e,t){return this.engine.queryGroupMemberInfo(e,t)}},{key:"inviteUsersIntoGroup",value:function(e,t){return this.engine.inviteUsersIntoGroup(e,t)}},{key:"kickGroupMembers",value:function(e,t){return this.engine.kickGroupMembers(e,t)}},{key:"queryGroupMemberList",value:function(e,t){return this.engine.queryGroupMemberList(e,t)}},{key:"queryGroupMemberCount",value:function(e){return this.engine.queryGroupMemberCount(e)}},{key:"callInvite",value:function(e,t){return this.engine.callInvite(e,t)}},{key:"callCancel",value:function(e,t,o){return this.engine.callCancel(e,t,o)}},{key:"callAccept",value:function(e,t){return this.engine.callAccept(e,t)}},{key:"callReject",value:function(e,t){return this.engine.callReject(e,t)}}],[{key:"getVersion",value:function(){return l.ZIMManager.getInstance().getVersion()}},{key:"create",value:function(t){var o="object"==(0,n.default)(t)?t.appID:t,r="object"==(0,n.default)(t)?t.appSign:"",i=l.ZIMManager.getInstance().createEngine(o,r);return i?(i.create(),e._instatance=new e(i),e._instatance):null}},{key:"getInstance",value:function(){return e._instatance}},{key:"setLogConfig",value:function(e){l.ZIMManager.getInstance().setLogConfig(e)}},{key:"setCacheConfig",value:function(e){l.ZIMManager.getInstance().setCacheConfig(e)}}]),e}();t.default=d,(0,s.default)(d,"_instatance",null)},"21a9":function(e,t,o){"use strict";var r,n,i,a,s,u,l,d,c,g,m,v,M,p,f,h,I,y,b,A,C,k,R,G;o("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.ZIMRoomState=t.ZIMRoomEvent=t.ZIMRoomAttributesUpdateAction=t.ZIMRevokeType=t.ZIMMessageType=t.ZIMMessageSentStatus=t.ZIMMessageRevokeStatus=t.ZIMMessageReceiptStatus=t.ZIMMessagePriority=t.ZIMMessageDirection=t.ZIMMediaFileType=t.ZIMGroupState=t.ZIMGroupMessageNotificationStatus=t.ZIMGroupMemberState=t.ZIMGroupMemberRole=t.ZIMGroupMemberEvent=t.ZIMGroupEvent=t.ZIMGroupAttributesUpdateAction=t.ZIMConversationType=t.ZIMConversationNotificationStatus=t.ZIMConversationEvent=t.ZIMConnectionState=t.ZIMConnectionEvent=t.ZIMCallUserState=void 0,t.ZIMConnectionState=r,function(e){e[e["Disconnected"]=0]="Disconnected",e[e["Connecting"]=1]="Connecting",e[e["Connected"]=2]="Connected",e[e["Reconnecting"]=3]="Reconnecting"}(r||(t.ZIMConnectionState=r={})),t.ZIMConnectionEvent=n,function(e){e[e["Success"]=0]="Success",e[e["ActiveLogin"]=1]="ActiveLogin",e[e["LoginTimeout"]=2]="LoginTimeout",e[e["LoginInterrupted"]=3]="LoginInterrupted",e[e["KickedOut"]=4]="KickedOut"}(n||(t.ZIMConnectionEvent=n={})),t.ZIMConversationType=i,function(e){e[e["Peer"]=0]="Peer",e[e["Room"]=1]="Room",e[e["Group"]=2]="Group"}(i||(t.ZIMConversationType=i={})),t.ZIMConversationEvent=a,function(e){e[e["Added"]=0]="Added",e[e["Updated"]=1]="Updated",e[e["Disabled"]=2]="Disabled"}(a||(t.ZIMConversationEvent=a={})),t.ZIMConversationNotificationStatus=s,function(e){e[e["Notify"]=1]="Notify",e[e["DoNotDisturb"]=2]="DoNotDisturb"}(s||(t.ZIMConversationNotificationStatus=s={})),t.ZIMMessagePriority=u,function(e){e[e["Low"]=1]="Low",e[e["Medium"]=2]="Medium",e[e["High"]=3]="High"}(u||(t.ZIMMessagePriority=u={})),t.ZIMMessageType=l,function(e){e[e["Unknown"]=0]="Unknown",e[e["Text"]=1]="Text",e[e["Command"]=2]="Command",e[e["Image"]=11]="Image",e[e["File"]=12]="File",e[e["Audio"]=13]="Audio",e[e["Video"]=14]="Video",e[e["Barrage"]=20]="Barrage",e[e["System"]=30]="System",e[e["Revoke"]=31]="Revoke"}(l||(t.ZIMMessageType=l={})),t.ZIMMessageSentStatus=d,function(e){e[e["Sending"]=0]="Sending",e[e["Success"]=1]="Success",e[e["Failed"]=2]="Failed"}(d||(t.ZIMMessageSentStatus=d={})),t.ZIMMessageDirection=c,function(e){e[e["Send"]=0]="Send",e[e["Receive"]=1]="Receive"}(c||(t.ZIMMessageDirection=c={})),t.ZIMMessageReceiptStatus=g,function(e){e[e["None"]=0]="None",e[e["Processing"]=1]="Processing",e[e["Done"]=2]="Done",e[e["Expired"]=3]="Expired",e[e["Failed"]=4]="Failed"}(g||(t.ZIMMessageReceiptStatus=g={})),t.ZIMMessageRevokeStatus=m,function(e){e[e["Unknown"]=-1]="Unknown",e[e["SelfRevoke"]=0]="SelfRevoke",e[e["SystemRevoke"]=1]="SystemRevoke",e[e["ServiceAPIRevoke"]=2]="ServiceAPIRevoke",e[e["GroupAdminRevoke"]=3]="GroupAdminRevoke",e[e["GroupOwnerRevoke"]=4]="GroupOwnerRevoke"}(m||(t.ZIMMessageRevokeStatus=m={})),t.ZIMRevokeType=v,function(e){e[e["TwoWay"]=0]="TwoWay",e[e["OneWay"]=1]="OneWay"}(v||(t.ZIMRevokeType=v={})),t.ZIMMediaFileType=M,function(e){e[e["OriginalFile"]=1]="OriginalFile",e[e["LargeImage"]=2]="LargeImage",e[e["Thumbnail"]=3]="Thumbnail",e[e["VideoFirstFrame"]=4]="VideoFirstFrame"}(M||(t.ZIMMediaFileType=M={})),t.ZIMRoomState=p,function(e){e[e["Disconnected"]=0]="Disconnected",e[e["Connecting"]=1]="Connecting",e[e["Connected"]=2]="Connected"}(p||(t.ZIMRoomState=p={})),t.ZIMRoomEvent=f,function(e){e[e["Success"]=0]="Success",e[e["NetworkInterrupted"]=1]="NetworkInterrupted",e[e["NetworkDisconnected"]=2]="NetworkDisconnected",e[e["RoomNotExist"]=3]="RoomNotExist",e[e["ActiveCreate"]=4]="ActiveCreate",e[e["CreateFailed"]=5]="CreateFailed",e[e["ActiveEnter"]=6]="ActiveEnter",e[e["EnterFailed"]=7]="EnterFailed",e[e["KickedOut"]=8]="KickedOut"}(f||(t.ZIMRoomEvent=f={})),t.ZIMRoomAttributesUpdateAction=h,function(e){e[e["Set"]=0]="Set",e[e["Delete"]=1]="Delete"}(h||(t.ZIMRoomAttributesUpdateAction=h={})),t.ZIMGroupMessageNotificationStatus=I,function(e){e[e["Notify"]=1]="Notify",e[e["Disturb"]=2]="Disturb"}(I||(t.ZIMGroupMessageNotificationStatus=I={})),t.ZIMGroupState=y,function(e){e[e["Quit"]=0]="Quit",e[e["Enter"]=1]="Enter"}(y||(t.ZIMGroupState=y={})),t.ZIMGroupEvent=b,function(e){e[e["Created"]=1]="Created",e[e["Dismissed"]=2]="Dismissed",e[e["Joined"]=3]="Joined",e[e["Invited"]=4]="Invited",e[e["Left"]=5]="Left",e[e["KickedOut"]=6]="KickedOut"}(b||(t.ZIMGroupEvent=b={})),t.ZIMGroupMemberState=A,function(e){e[e["Quit"]=0]="Quit",e[e["Enter"]=1]="Enter"}(A||(t.ZIMGroupMemberState=A={})),t.ZIMGroupMemberEvent=C,function(e){e[e["Joined"]=1]="Joined",e[e["Left"]=2]="Left",e[e["KickedOut"]=4]="KickedOut",e[e["Invited"]=5]="Invited"}(C||(t.ZIMGroupMemberEvent=C={})),t.ZIMGroupMemberRole=k,function(e){e[e["Owner"]=1]="Owner",e[e["Member"]=3]="Member"}(k||(t.ZIMGroupMemberRole=k={})),t.ZIMGroupAttributesUpdateAction=R,function(e){e[e["Set"]=0]="Set",e[e["Delete"]=1]="Delete"}(R||(t.ZIMGroupAttributesUpdateAction=R={})),t.ZIMCallUserState=G,function(e){e[e["Inviting"]=0]="Inviting",e[e["Accepted"]=1]="Accepted",e[e["Rejected"]=2]="Rejected",e[e["Cancelled"]=3]="Cancelled",e[e["Offline"]=4]="Offline",e[e["Received"]=5]="Received"}(G||(t.ZIMCallUserState=G={}))},"3ac0":function(e,t,o){"use strict";o("6a54");var r=o("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.ZIMParamValid=void 0;var n=r(o("80b1")),i=r(o("efe5")),a=r(o("39d8")),s=r(o("b7c7"));o("4db2"),o("bf0f"),o("c976"),o("4d8f"),o("7b97"),o("668a"),o("c5b7"),o("8ff5"),o("2378"),o("641a"),o("64e0"),o("cce3"),o("efba"),o("d009"),o("bd7d"),o("7edd"),o("d798"),o("f547"),o("5e54"),o("b60a"),o("8c18"),o("12973"),o("f991"),o("198e"),o("8557"),o("63b1"),o("1954"),o("1cf1"),o("fd3c"),o("08eb"),o("18f7"),o("dc8a"),o("0c26");var u=o("7990"),l=o("f167"),d={MAX_ID_SIZE:1024,MAX_NAME_SIZE:2048,MAX_MESSAGE_SIZE:49152},c=function(e){return"string"==typeof e?new Uint8Array(Array.from(unescape(encodeURIComponent(e||""))).map((function(e){return e.charCodeAt(0)}))):e},g=function(e,t){return{code:e,message:t}},m=function(e,t){return!!e&&"string"==typeof e&&e.length<=d.MAX_ID_SIZE&&(!t||t&&"#"!=e[0])},v=function(){function e(t){(0,n.default)(this,e),(0,a.default)(this,"logger",void 0),(0,a.default)(this,"_isValidName",(function(e){return"string"==typeof e&&e.length<=d.MAX_NAME_SIZE})),(0,a.default)(this,"_isValidAttribute",(function(e,t){if(!e||"[object Object]"!==Object.prototype.toString.call(e))return!1;var o=Object.keys(e);return!(!t&&!o.length)&&Object.keys(e).every((function(t){return"string"==typeof t&&"string"==typeof e[t]}))})),this.logger=t}return(0,i.default)(e,[{key:"validID",value:function(e,t,o,r){if(!m(e)){var n=g(l.ZIMErrorCode.CommonModuleParamInvalid,e+" is invalid.");this.logger.warn([o],r,(0,a.default)({error:n},e,t))}}},{key:"validName",value:function(e,t,o,r){if(!this._isValidName(t)){var n=g(l.ZIMErrorCode.CommonModuleParamInvalid,e+" is invalid.");return this.logger.warn([o],r,(0,a.default)({error:n},e,t)),n}}},{key:"validTwoID",value:function(e,t,o,r,n,i){var s="";if(!m(t)&&(s=e+" is invalid.")||!m(r)&&(s=o+" is invalid.")){var u,d=g(l.ZIMErrorCode.CommonModuleParamInvalid,s);return this.logger.warn([n],i,(u={error:d},(0,a.default)(u,e,t),(0,a.default)(u,o,r),u)),d}}},{key:"validTwoName",value:function(e,t,o,r,n,i){var s="";if(!this._isValidName(t)&&(s=e+" is invalid.")||!this._isValidName(r)&&(s=o+" is invalid.")){var u,d=g(l.ZIMErrorCode.CommonModuleParamInvalid,s);return this.logger.warn([n],i,(u={error:d},(0,a.default)(u,e,t),(0,a.default)(u,o,r),u)),d}}},{key:"validIDAndName",value:function(e,t,o,r,n,i){var s="";if(!m(t)&&(s=e+" is invalid.")||!this._isValidName(r)&&(s=o+" is invalid.")){var u,d=g(l.ZIMErrorCode.CommonModuleParamInvalid,s);return this.logger.warn([n],i,(u={error:d},(0,a.default)(u,e,t),(0,a.default)(u,o,r),u)),d}}},{key:"login",value:function(e){var t="";if(!e&&(t="userInfo is invalid.")||!m(e.userID)&&(t="The userInfo instance of userID is invalid.")||!this._isValidName(e.userName)&&(t="The userInfo instance of userName is invalid.")){var o=g(l.ZIMErrorCode.CommonModuleParamInvalid,t);return this.logger.warn([u.ZIMLogTag.User],u.ZIMLogAction.Login,{error:o,userInfo:e}),o}}},{key:"queryUsersInfo",value:function(e){if(!Array.isArray(e)||!e.length){var t=g(l.ZIMErrorCode.CommonModuleParamInvalid,"userIDs is invalid.");return this.logger.warn([u.ZIMLogTag.User],u.ZIMLogAction.QueryUsersInfo,{error:t,userIDs:e}),t}}},{key:"validConvIDAndType",value:function(e,t,o){var r="";if(!m(e)&&(r="conversationID is invalid.")||t!==l.ZIMConversationType.Peer&&t!==l.ZIMConversationType.Group&&(r="conversationType is invalid.")){var n=g(l.ZIMErrorCode.CommonModuleParamInvalid,r);return this.logger.warn([u.ZIMLogTag.Conversation],o,{error:n,conversationID:e,conversationType:t}),n}}},{key:"queryConversationList",value:function(e){var t="";if(!e&&(t="config is invalid.")||("number"!=typeof e.count||e.count<0)&&(t="The config instance of count is invalid.")){var o=g(l.ZIMErrorCode.CommonModuleParamInvalid,t);return this.logger.warn([u.ZIMLogTag.Conversation],u.ZIMLogAction.QueryConversationList,{error:o,config:e}),o}}},{key:"setConversationNotificationStatus",value:function(e,t,o){var r="";if(!m(t)&&(r="conversationID is invalid.")||o!==l.ZIMConversationType.Group&&(r="conversationType is not support.")||e!==l.ZIMConversationNotificationStatus.Notify&&e!==l.ZIMConversationNotificationStatus.DoNotDisturb&&(r="status is invalid.")){var n=g(l.ZIMErrorCode.CommonModuleParamInvalid,r),i={error:n,conversationID:t,conversationType:o,status:e};return this.logger.warn([u.ZIMLogTag.Conversation],u.ZIMLogAction.SetConversationNotificationStatus,i),n}}},{key:"sendMessage",value:function(e,t,o,r){var n="";if(!m(t)&&(n="toConversationID is invalid.")||!this._checkConvType(o)&&(n="conversationType is invalid.")||!e&&(n="message is invalid.")||!r&&(n="config is invalid.")||!this._checkMesageType(e.type,o)&&(n="message type is invalid.")||!this._checkMesagePriority(r.priority)&&(n="config priority is invalid.")||!this._checkMesageContent(o,e.type,e.message)&&(n="The message instance of message is invalid.")||!this._checkMessageReceipt(o,e.type,r.hasReceipt)&&(n="The message type is not support setting receipt.")){var i=g(l.ZIMErrorCode.CommonModuleParamInvalid,n),a={error:i,toConversationID:t,conversationType:o,message:e,config:r};return this.logger.warn([u.ZIMLogTag.Conversation],u.ZIMLogAction.SendMessage,a),i}}},{key:"sendMediaMessage",value:function(e,t,o,r){var n="";if(!m(t)&&(n="toConversationID is invalid.")||!this._checkConvType(o)&&(n="conversationType is invalid.")||!e&&(n="message is invalid.")||!r&&(n="config is invalid.")||!this._checkMediaMesageType(e.type)&&(n="message type is invalid.")||!this._checkMesagePriority(r.priority)&&(n="config priority is invalid.")||!this._checkMessageReceipt(o,e.type,r.hasReceipt)&&(n="The message type is not support setting receipt.")||!e.fileLocalPath&&!e.fileDownloadUrl&&(n="The message instance of fileLocalPath and fileDownloadUrl is empty.")){var i=g(l.ZIMErrorCode.CommonModuleParamInvalid,n),a={error:i,toConversationID:t,conversationType:o,message:e,config:r};return this.logger.warn([u.ZIMLogTag.Conversation],u.ZIMLogAction.SendMediaMessage,a),i}}},{key:"deleteMessages",value:function(e,t,o,r){var n=this.validConvIDAndType(t,o,u.ZIMLogAction.DeleteMessages);return n||(!Array.isArray(e)||!e.length&&r.isAlsoDeleteServerMessage?(this.logger.warn([u.ZIMLogTag.Conversation],u.ZIMLogAction.DeleteMessages,{error:n,messageList:e,config:r}),g(l.ZIMErrorCode.CommonModuleParamInvalid,"messageList is invalid.")):void 0)}},{key:"queryHistoryMessage",value:function(e,t,o){var r="";if(!m(e)&&(r="conversationID is invalid.")||!this._checkConvType(t)&&(r="conversationType is invalid.")||!o&&(r="config is invalid.")||("number"!=typeof o.count||o.count<0)&&(r="The config instance of count is invalid.")){var n=g(l.ZIMErrorCode.CommonModuleParamInvalid,r),i={error:n,conversationID:e,conversationType:t};return this.logger.warn([u.ZIMLogTag.Conversation],u.ZIMLogAction.QueryHistoryMessage,i),n}}},{key:"downloadMediaFile",value:function(e,t){var o="";if(!e&&(o="message is invalid.")||!e.fileDownloadUrl&&(o="The message instance of fileDownloadUrl is empty.")||!this._checkMediaMesageType(e.type)&&(o="message type is invalid.")||!this._checkMediaFileType(t)&&(o="fileType is invalid.")){var r=g(l.ZIMErrorCode.CommonModuleParamInvalid,o),n={error:r,fileType:t,message:e};return this.logger.warn([u.ZIMLogTag.Conversation],u.ZIMLogAction.DownloadMediaFile,n),r}}},{key:"insertMessageToLocalDB",value:function(e,t,o,r){var n=this.validConvIDAndType(t,o,u.ZIMLogAction.InsertMessageToLocalDB);if(n)return n;var i="";if(!m(r)&&(i="senderUserID is invalid.")||!e&&(i="message is invalid.")||!this._checkInsertMesageType(e.type)&&(i="message type is invalid.")||!this._checkInsertMesageContent(e)&&(i="The message instance of message is invalid.")){var a=g(l.ZIMErrorCode.CommonModuleParamInvalid,i),s={error:a,conversationID:t,conversationType:o,senderUserID:r,message:e};return this.logger.warn([u.ZIMLogTag.Conversation],u.ZIMLogAction.InsertMessageToLocalDB,s),a}}},{key:"sendConversationMessageReceiptRead",value:function(e,t){var o="";if(!m(e)&&(o="conversationID is invalid.")||t!==l.ZIMConversationType.Peer&&(o="conversationType is invalid.")){var r=g(l.ZIMErrorCode.CommonModuleParamInvalid,o),n={error:r,conversationID:e,conversationType:t};return this.logger.warn([u.ZIMLogTag.Conversation],u.ZIMLogAction.SendConversationMessageReceiptRead,n),r}}},{key:"sendMessageReceiptsRead",value:function(e,t,o){var r=this.validConvIDAndType(t,o,u.ZIMLogAction.SendMessageReceiptsRead);if(r)return r;var n="";if(Array.isArray(e)&&0!=e.length){var i=e.some((function(e){return e.conversationID==t&&e.conversationType==o&&e.direction==l.ZIMMessageDirection.Receive&&e.receiptStatus==l.ZIMMessageReceiptStatus.Processing}));i||(n="Every one of message list is not a received receipt message in the conversationID.")}else n="messageList is invalid.";if(n){var a=g(l.ZIMErrorCode.CommonModuleParamInvalid,n),s={error:a,conversationID:t,conversationType:o,messageList:e};return this.logger.warn([u.ZIMLogTag.Conversation],u.ZIMLogAction.SendMessageReceiptsRead,s,!0),a}}},{key:"queryMessageReceiptsInfo",value:function(e,t,o){var r=this.validConvIDAndType(t,o,u.ZIMLogAction.QueryMessageReceiptsInfo);if(r)return r;var n="";if(Array.isArray(e)&&0!=e.length){var i=e.every((function(e){return!e.receiptStatus||e.conversationID!==t||e.conversationType!==o}));i&&(n="Every one of message list is not a receipt message in the conversationID.")}else n="messageList is invalid.";if(n){var a=g(l.ZIMErrorCode.CommonModuleParamInvalid,n),s={error:a,conversationID:t,conversationType:o,messageList:e};return this.logger.warn([u.ZIMLogTag.Conversation],u.ZIMLogAction.QueryMessageReceiptsInfo,s,!0),a}}},{key:"queryGroupMessageReceiptMemberList",value:function(e,t,o,r,n){var i="";if(!m(t)&&(i="groupID is invalid.")||(!o||"number"!=typeof o.count||o.count<0)&&(i="config or the config instance of count is invalid.")||!e&&(i="message is invalid.")||(e.senderUserID!=n||e.sentStatus!=l.ZIMMessageSentStatus.Success||!e.receiptStatus)&&(i="The message instance is not a successful receipt message sent by self.")||(e.type==l.ZIMMessageType.Command||e.type==l.ZIMMessageType.Revoke)&&(i="The message type is not support.")||(e.conversationID!==t||e.conversationType!==l.ZIMConversationType.Group)&&(i="The message instance is not belong the groupID.")){var a=g(l.ZIMErrorCode.CommonModuleParamInvalid,i),s=r?u.ZIMLogAction.QueryGroupMessageReceiptReadMemberList:u.ZIMLogAction.QueryGroupMessageReceiptUnreadMemberList;return this.logger.warn([u.ZIMLogTag.Group],s,{error:a,groupID:t,message:e,config:o}),a}}},{key:"revokeMessage",value:function(e,t){var o="";if(!e&&(o="message is invalid.")||(e.isUserInserted||e.senderUserID!=t||e.sentStatus!=l.ZIMMessageSentStatus.Success)&&(o="The message instance is not a send successful message.")||e.conversationType!==l.ZIMConversationType.Peer&&e.conversationType!==l.ZIMConversationType.Group&&(o="Only peer and group message can be revoked.")){var r=g(l.ZIMErrorCode.CommonModuleParamInvalid,o);return this.logger.warn([u.ZIMLogTag.Conversation],u.ZIMLogAction.RevokeMessage,{error:r,message:e}),r}}},{key:"createRoom",value:function(e,t,o){var r="";if(!e&&(r="roomInfo is invalid.")||!m(e.roomID)&&(r="The roomInfo instance of roomID is invalid.")||!this._isValidName(e.roomName)&&(r="The roomInfo instance of roomName is invalid.")||t&&t.roomAttributes&&!this._isValidAttribute(t.roomAttributes,!0)&&(r="The Key and Value of the roomAttributes property of the config instance only support string types.")){var n=g(l.ZIMErrorCode.CommonModuleParamInvalid,r),i=o?u.ZIMLogAction.EnterRoom:u.ZIMLogAction.CreateRoom;return this.logger.warn([u.ZIMLogTag.Room],i,{error:n,roomInfo:e,config:t}),n}}},{key:"queryRoomMemberList",value:function(e,t){var o="";if(!m(e)&&(o="roomID is invalid.")||(!t||"number"!=typeof t.count||t.count<0)&&(o="config or the config instance of count is invalid.")){var r=g(l.ZIMErrorCode.CommonModuleParamInvalid,o);return this.logger.warn([u.ZIMLogTag.Room],u.ZIMLogAction.QueryRoomMemberList,{error:r,roomID:e,config:t}),r}}},{key:"setRoomAttributes",value:function(e,t){var o="";if(!m(t)&&(o="roomID is invalid.")||!this._isValidAttribute(e)&&(o="The Key and Value of the roomAttributes only support string types.")){var r=g(l.ZIMErrorCode.CommonModuleParamInvalid,o);return this.logger.warn([u.ZIMLogTag.Room],u.ZIMLogAction.SetRoomAttributes,{error:r,roomID:t,roomAttributes:e}),r}}},{key:"deleteRoomAttributes",value:function(e,t){var o="";if(!m(t)&&(o="roomID is invalid.")||(!Array.isArray(e)||!e.length||e.some((function(e){return!e||"string"!==typeof e})))&&(o="Every one of keys must be a valid string type.")){var r=g(l.ZIMErrorCode.CommonModuleParamInvalid,o);return this.logger.warn([u.ZIMLogTag.Room],u.ZIMLogAction.DeleteRoomAttributes,{error:r,roomID:t,keys:e}),r}}},{key:"setRoomMembersAttributes",value:function(e,t,o){var r="";if(!m(o)&&(r="roomID is invalid.")||!this._isValidAttribute(e)&&(r="The Key and Value of the attributes only support string types.")||(!Array.isArray(t)||!t.length||t.some((function(e){return!e||"string"!==typeof e})))&&(r="Every one of userIDs must be a valid string type.")){var n=g(l.ZIMErrorCode.CommonModuleParamInvalid,r);return this.logger.warn([u.ZIMLogTag.Room],u.ZIMLogAction.SetRoomMembersAttributes,{error:n,roomID:o,attributes:e}),n}}},{key:"queryRoomMembersAttributes",value:function(e,t){var o="";if(!m(t)&&(o="roomID is invalid.")||(!Array.isArray(e)||!e.length||e.some((function(e){return!e||"string"!==typeof e})))&&(o="Every one of userIDs must be a valid string type.")){var r=g(l.ZIMErrorCode.CommonModuleParamInvalid,o);return this.logger.warn([u.ZIMLogTag.Room],u.ZIMLogAction.QueryRoomMembersAttributes,{error:r,roomID:t,userIDs:e}),r}}},{key:"queryRoomMemberAttributesList",value:function(e,t){var o="";if(!m(e)&&(o="roomID is invalid.")||(!t||"number"!=typeof t.count||t.count<0)&&(o="config or the config instance of count is invalid.")){var r=g(l.ZIMErrorCode.CommonModuleParamInvalid,o);return this.logger.warn([u.ZIMLogTag.Room],u.ZIMLogAction.QueryRoomMemberAttributesList,{error:r,roomID:e,config:t}),r}}},{key:"validGroupUserIDs",value:function(e,t,o){var r="";if((!Array.isArray(e)||!e.length||e.some((function(e){return!e||"string"!==typeof e})))&&(r="Every one of userIDs must be a valid string type.")||!m(t)&&(r="groupID is invalid.")){var n=g(l.ZIMErrorCode.CommonModuleParamInvalid,r);return this.logger.warn([u.ZIMLogTag.Group],o,{error:n,groupID:t,userIDs:e}),n}}},{key:"createGroup",value:function(e,t,o){var r=String(e.groupID||"").trim(),n="",i=r&&!m(r,!0)&&(n="The groupInfo instance of groupID is invalid.")||!this._isValidName(e.groupName)&&(n="The groupInfo instance of groupName is invalid.")||!this._isValidName(e.groupAvatarUrl)&&(n="The groupInfo instance of groupAvatarUrl is invalid.")||!this._isValidName(o.groupNotice)&&(n="The config instance of groupNotice is invalid.")||t&&!Array.isArray(t)&&(n="Every one of userIDs must be a valid string type.")||!this._isValidAttribute(o.groupAttributes,!0)&&(n="The Key and Value of the groupAttributes property of the config instance only support string types.");if(i){var a=g(l.ZIMErrorCode.CommonModuleParamInvalid,n);return this.logger.warn([u.ZIMLogTag.Group],u.ZIMLogAction.CreateGroup,{error:a,groupInfo:e,config:o,userIDs:t}),a}}},{key:"setGroupAttributes",value:function(e,t){var o="";if(!m(t)&&(o="groupID is invalid.")||!this._isValidAttribute(e)&&(o="The Key and Value of the groupAttributes only support string types.")){var r=g(l.ZIMErrorCode.CommonModuleParamInvalid,o);return this.logger.warn([u.ZIMLogTag.Group],u.ZIMLogAction.SetGroupAttributes,{error:r,groupID:t,groupAttributes:e}),r}}},{key:"deleteGroupAttributes",value:function(e,t){var o="";if(!m(t)&&(o="groupID is invalid.")||(!Array.isArray(e)||!e.length||e.some((function(e){return!e||"string"!==typeof e})))&&(o="Every one of kyes must be a valid string type.")){var r=g(l.ZIMErrorCode.CommonModuleParamInvalid,o);return this.logger.warn([u.ZIMLogTag.Group],u.ZIMLogAction.DeleteGroupAttributes,{error:r,groupID:t,keys:e}),r}}},{key:"queryGroupAttributes",value:function(e,t){var o="";if(!m(e)&&(o="groupID is invalid.")||Array.isArray(t)&&(!t.length||t.some((function(e){return!e||"string"!==typeof e})))&&(o="Every one of kyes must be a valid string type.")){var r=g(l.ZIMErrorCode.CommonModuleParamInvalid,o);return this.logger.warn([u.ZIMLogTag.Group],u.ZIMLogAction.QueryGroupAttributes,{error:r,groupID:e,keys:t}),r}}},{key:"setGroupMemberNickname",value:function(e,t,o){var r="";if(!this._isValidName(e)&&(r="nickname is invalid.")||!m(t)&&(r="forUserID is invalid.")||!m(o)&&(r="groupID is invalid.")){var n=g(l.ZIMErrorCode.CommonModuleParamInvalid,r),i={error:n,groupID:o,forUserID:t,nickname:e};return this.logger.warn([u.ZIMLogTag.Group],u.ZIMLogAction.SetGroupMemberNickname,i),n}}},{key:"setGroupMemberRole",value:function(e,t,o){var r="";if("number"!==typeof e&&(r="role is invalid.")||!m(t)&&(r="forUserID is invalid.")||!m(o)&&(r="groupID is invalid.")){var n=g(l.ZIMErrorCode.CommonModuleParamInvalid,r);return this.logger.warn([u.ZIMLogTag.Group],u.ZIMLogAction.SetGroupMemberRole,{error:n,groupID:o,forUserID:t,role:e}),n}}},{key:"callInvite",value:function(e,t){var o="";if((!Array.isArray(e)||!e.length)&&(o="invitees is invalid.")||t&&"number"==typeof t.timeout&&(t.timeout%1!=0||t.timeout<1||t.timeout>600)&&(o="The config instance of timeout is invalid.")){var r=g(l.ZIMErrorCode.CommonModuleParamInvalid,o);return this.logger.warn([u.ZIMLogTag.Call],u.ZIMLogAction.CallInvite,{error:r,invitees:e,config:t}),r}}},{key:"callCancel",value:function(e,t){var o="";if(!m(t)&&(o="callID is invalid.")||(!Array.isArray(e)||!e.length)&&(o="invitees is invalid.")){var r=g(l.ZIMErrorCode.CommonModuleParamInvalid,o);return this.logger.warn([u.ZIMLogTag.Call],u.ZIMLogAction.CallCancel,{error:r,callID:t,invitees:e}),r}}},{key:"_checkMesageContent",value:function(e,t,o){return!((t===l.ZIMMessageType.Text||t===l.ZIMMessageType.Barrage&&e===l.ZIMConversationType.Room)&&("string"!==typeof o||!o||!o.trim()||c(o).length>d.MAX_MESSAGE_SIZE))&&!!(t!==l.ZIMMessageType.Command||o instanceof Uint8Array&&o.length&&!(o.length>d.MAX_MESSAGE_SIZE)&&function(e){if("string"==typeof e)return e;if(!e||!e.length)return"";var t=String.fromCharCode.apply(String,(0,s.default)(Array.from(e)));try{return decodeURIComponent(escape(t))}catch(o){return decodeURIComponent(t)}}(o).trim())}},{key:"_checkMesagePriority",value:function(e){return e===l.ZIMMessagePriority.Low||e===l.ZIMMessagePriority.Medium||e===l.ZIMMessagePriority.High}},{key:"_checkMesageType",value:function(e,t){return e===l.ZIMMessageType.Text||e===l.ZIMMessageType.Command||t===l.ZIMConversationType.Room&&e===l.ZIMMessageType.Barrage}},{key:"_checkMediaMesageType",value:function(e){return e===l.ZIMMessageType.Image||e===l.ZIMMessageType.File||e===l.ZIMMessageType.Audio||e===l.ZIMMessageType.Video}},{key:"_checkMediaFileType",value:function(e){return e===l.ZIMMediaFileType.OriginalFile||e===l.ZIMMediaFileType.LargeImage||e===l.ZIMMediaFileType.Thumbnail||e===l.ZIMMediaFileType.VideoFirstFrame}},{key:"_checkInsertMesageType",value:function(e){return e===l.ZIMMessageType.Text||e===l.ZIMMessageType.System||e===l.ZIMMessageType.Image||e===l.ZIMMessageType.File||e===l.ZIMMessageType.Audio||e===l.ZIMMessageType.Video}},{key:"_checkInsertMesageContent",value:function(e){var t=e.message;if((e.type===l.ZIMMessageType.Text||e.type===l.ZIMMessageType.System)&&("string"!==typeof t||!t||!t.trim()||c(t).length>d.MAX_MESSAGE_SIZE))return!1;var o=e;return!(e.type>=l.ZIMMessageType.Image&&e.type<=l.ZIMMessageType.Video&&!o.fileLocalPath&&!o.fileDownloadUrl)}},{key:"_checkConvType",value:function(e){return e===l.ZIMConversationType.Peer||e===l.ZIMConversationType.Room||e===l.ZIMConversationType.Group}},{key:"_checkMessageReceipt",value:function(e,t,o){return!o||e!=l.ZIMConversationType.Room&&t!=l.ZIMMessageType.Command&&t!=l.ZIMMessageType.Barrage}}]),e}();t.ZIMParamValid=v},"3b76":function(e,t,o){"use strict";o("6a54"),Object.defineProperty(t,"__esModule",{value:!0})},"3c28":function(e,t,o){var r=o("dd80");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var n=o("967d").default;n("2666754a",r,!0,{sourceMap:!1,shadowMode:!1})},7990:function(e,t,o){"use strict";(function(e){o("6a54");var r=o("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.ZIMLogger=t.ZIMLogTag=t.ZIMLogAction=void 0,o("d4b5"),o("4db2"),o("bf0f"),o("c976"),o("4d8f"),o("7b97"),o("668a"),o("c5b7"),o("8ff5"),o("2378"),o("641a"),o("64e0"),o("cce3"),o("efba"),o("d009"),o("bd7d"),o("7edd"),o("d798"),o("f547"),o("5e54"),o("b60a"),o("8c18"),o("12973"),o("f991"),o("198e"),o("8557"),o("63b1"),o("1954"),o("1cf1");var n,i,a=r(o("80b1")),s=r(o("efe5")),u=function(){function t(){(0,a.default)(this,t)}return(0,s.default)(t,[{key:"warn",value:function(t,o,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.log(o,r&&"string"!=typeof r?this.stringify(r,n):r||"")}},{key:"stringify",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=JSON.stringify(e,(function(e,o){if(o instanceof Uint8Array)return"b="+o.length;if(o instanceof Array&&o.length>2&&t){var r=o.length;return[r,o[0],o[r-1]]}return"string"==typeof o&&t&&o.length>128?"s="+o.length:o}));return o}}]),t}();t.ZIMLogger=u,t.ZIMLogTag=n,function(e){e["User"]="User",e["Conversation"]="Conversation",e["Room"]="Room",e["Group"]="Group",e["Call"]="Call"}(n||(t.ZIMLogTag=n={})),t.ZIMLogAction=i,function(e){e["Login"]="JSAPI.login",e["QueryUsersInfo"]="JSAPI.queryUsersInfo",e["UpdateUserName"]="JSAPI.updateUserName",e["UpdateUserAvatarUrl"]="JSAPI.updateUserAvatarUrl",e["UpdateUserExtendedData"]="JSAPI.updateUserExtendedData",e["QueryConversationList"]="JSAPI.queryConversationList",e["DeleteConversation"]="JSAPI.deleteConversation",e["ClearConversationUnreadMessageCount"]="JSAPI.clearConversationUnreadMessageCount",e["SetConversationNotificationStatus"]="JSAPI.setConversationNotificationStatus",e["SendMessage"]="JSAPI.sendMessage",e["SendMediaMessage"]="JSAPI.sendMediaMessage",e["DeleteMessages"]="JSAPI.deleteMessages",e["DeleteAllMessage"]="JSAPI.deleteAllMessage",e["QueryHistoryMessage"]="JSAPI.queryHistoryMessage",e["DownloadMediaFile"]="JSAPI.downloadMediaFile",e["InsertMessageToLocalDB"]="JSAPI.insertMessageToLocalDB",e["SendConversationMessageReceiptRead"]="JSAPI.sendConversationMessageReceiptRead",e["SendMessageReceiptsRead"]="JSAPI.sendMessageReceiptsRead",e["QueryMessageReceiptsInfo"]="JSAPI.queryMessageReceiptsInfo",e["QueryGroupMessageReceiptReadMemberList"]="JSAPI.queryGroupMessageReceiptReadMemberList",e["QueryGroupMessageReceiptUnreadMemberList"]="JSAPI.QueryGroupMessageReceiptUnreadMemberList",e["RevokeMessage"]="JSAPI.RevokeMessage",e["CreateRoom"]="JSAPI.createRoom",e["JoinRoom"]="JSAPI.joinRoom",e["LeaveRoom"]="JSAPI.leaveRoom",e["QueryRoomMemberList"]="JSAPI.queryRoomMemberList",e["QueryRoomOnlineMemberCount"]="JSAPI.queryRoomOnlineMemberCount",e["SetRoomAttributes"]="JSAPI.setRoomAttributes",e["DeleteRoomAttributes"]="JSAPI.deleteRoomAttributes",e["QueryRoomAllAttributes"]="JSAPI.queryRoomAllAttributes",e["BeginRoomAttributesBatchOperation"]="JSAPI.beginRoomAttributesBatchOperation",e["EndRoomAttributesBatchOperation"]="JSAPI.endRoomAttributesBatchOperation",e["SetRoomMembersAttributes"]="JSAPI.setRoomMembersAttributes",e["QueryRoomMembersAttributes"]="JSAPI.queryRoomMembersAttributes",e["QueryRoomMemberAttributesList"]="JSAPI.queryRoomMemberAttributesList",e["CreateGroup"]="JSAPI.createGroup",e["EnterRoom"]="JSAPI.enterRoom",e["JoinGroup"]="JSAPI.joinGroup",e["DismissGroup"]="JSAPI.dismissGroup",e["LeaveGroup"]="JSAPI.leaveGroup",e["InviteUsersIntoGroup"]="JSAPI.inviteUsersIntoGroup",e["KickGroupMembers"]="JSAPI.kickGroupMembers",e["QueryGroupList"]="JSAPI.queryGroupList",e["QueryGroupMemberList"]="JSAPI.queryGroupMemberList",e["QueryGroupMemberCount"]="JSAPI.queryGroupMemberCount",e["TransferGroupOwner"]="JSAPI.transferGroupOwner",e["QueryGroupInfo"]="JSAPI.queryGroupInfo",e["UpdateGroupName"]="JSAPI.updateGroupName",e["UpdateGroupNotice"]="JSAPI.updateGroupNotice",e["UpdateGroupAvatarUrl"]="JSAPI.updateGroupAvatarUrl",e["SetGroupAttributes"]="JSAPI.setGroupAttributes",e["DeleteGroupAttributes"]="JSAPI.deleteGroupAttributes",e["QueryGroupAttributes"]="JSAPI.queryGroupAttributes",e["SetGroupMemberNickname"]="JSAPI.setGroupMemberNickname",e["SetGroupMemberRole"]="JSAPI.setGroupMemberRole",e["QueryGroupMemberInfo"]="JSAPI.queryGroupMemberInfo",e["CallInvite"]="JSAPI.callInvite",e["CallCancel"]="JSAPI.callCancel",e["CallAccept"]="JSAPI.callAccept",e["CallReject"]="JSAPI.callReject"}(i||(t.ZIMLogAction=i={}))}).call(this,o("ba7c")["default"])},"7aae":function(e,t,o){"use strict";o.d(t,"b",(function(){return n})),o.d(t,"c",(function(){return i})),o.d(t,"a",(function(){return r}));var r={tuiNavigationBar:o("9ebd").default,tuiIcon:o("bd7a").default,tuiBubblePopup:o("d3de").default,tuiButton:o("e718").default},n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-uni-view",[o("v-uni-view",{staticClass:"container",style:{"padding-bottom":52+e.inputBottom+"px"}},[o("v-uni-view",{staticClass:"header"},[o("tui-navigation-bar",{attrs:{backgroundColor:"#fff",isFixed:!0,isOpacity:!1}},[o("v-uni-view",{staticClass:"nav"},[o("tui-icon",{attrs:{name:"arrowleft",size:"25"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.back.apply(void 0,arguments)}}}),o("v-uni-view",{staticClass:"username"},[e._v(e._s(e.toUserInfo.username))]),o("tui-icon",{attrs:{name:"more-fill",size:"22"}})],1)],1)],1),o("v-uni-scroll-view",{staticClass:"content",attrs:{"scroll-y":!0,"scroll-top":e.scrollTop,"refresher-enabled":"true","refresher-triggered":e.triggered},on:{refresherrefresh:function(t){arguments[0]=t=e.$handleEvent(t),e.onRefresh.apply(void 0,arguments)}}},e._l(e.dataList,(function(t,r){return o("v-uni-view",{attrs:{id:"chatBox"}},[t.sendId!=e.userInfo.id?o("v-uni-view",{staticClass:"tui-chat-item"},[o("v-uni-image",{staticClass:"tui-user-avatar tui-mr",attrs:{src:t.avatar,mode:"aspectFill"}}),o("v-uni-view",{staticClass:"tui-chat-box"},[o("tui-bubble-popup",{attrs:{direction:"left",position:"relative",mask:!1,show:!0,triangleLeft:"-22rpx",triangleTop:"30rpx",width:"100%",backgroundColor:"#ff7900"}},[o("v-uni-view",{staticClass:"tui-chat-text"},[e._v(e._s(t.content))])],1)],1)],1):o("v-uni-view",{staticClass:"tui-chat-item tui-flex-end"},[o("v-uni-view",{staticClass:"tui-chat-box"},[o("tui-bubble-popup",{attrs:{direction:"right",position:"relative",mask:!1,show:!0,triangleRight:"-22rpx",triangleTop:"30rpx",width:"100%",flexEnd:!0,backgroundColor:"#19be6b"}},[o("v-uni-view",{staticClass:"tui-chat-text"},[e._v(e._s(t.content))])],1)],1),o("v-uni-image",{staticClass:"tui-user-avatar tui-ml",attrs:{src:t.avatar,mode:"aspectFill"}})],1)],1)})),1)],1),o("v-uni-view",{staticClass:"bottom-textarea",style:{bottom:e.inputBottom+"px"}},[o("v-uni-view",{staticClass:"textarea-container"},[o("v-uni-textarea",{attrs:{maxlength:-1,"auto-height":!0,"show-confirm-bar":!1,"cursor-spacing":10,fixed:!0,"adjust-position":!1},on:{focus:function(t){arguments[0]=t=e.$handleEvent(t),e.focusTextarea.apply(void 0,arguments)},blur:function(t){arguments[0]=t=e.$handleEvent(t),e.blurTextarea.apply(void 0,arguments)}},model:{value:e.recordInput,callback:function(t){e.recordInput=t},expression:"recordInput"}})],1),o("tui-button",{attrs:{type:"danger",height:"80rpx",width:"100rpx"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.send()}}},[e._v("发送")])],1)],1)},i=[]},"7c93":function(e,t,o){"use strict";(function(e){o("6a54");var r=o("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(o("b7c7"));o("aa9c"),o("dc69"),o("3efd");var i=o("bf47"),a=o("292f"),s=r(o("f167"));s.default.create({appID:1562974438});var u=s.default.getInstance(),l={data:function(){return{records:[],recordInput:"",itemAverageHeight:500,scrollTop:1e3,inputBottom:0,userInfo:{},toUid:"",page:1,limit:10,total:0,dataList:[],toUserInfo:{},triggered:!1,version:0}},onLoad:function(e){this.toUid=e.toUid,this.userInfo=uni.getStorageSync("userInfo"),this.getToUserInfo()},created:function(){this.createws()},onShow:function(){this.getList()},onBackPress:function(){e.log("左滑退出"),u.logout()},methods:{back:function(){u.logout(),uni.navigateBack({delta:1})},getToUserInfo:function(){var e=this,t={uid:this.toUid};(0,a.getUserInfo)(t).then((function(t){e.toUserInfo=t.data}))},createws:function(){var t=this,o={userId:t.userInfo.id};(0,i.getZimToken)(o).then((function(o){e.log("得到信息",o);var r={userID:t.userInfo.id,userName:t.userInfo.username},n=o.data;u.login(r,n).then((function(){e.log("登录成功")})).catch((function(e){}))})),u.on("error",(function(t,o){e.log("error",o.code,o.message)})),u.on("connectionStateChanged",(function(e,t){t.state,t.event,t.extendedData})),u.on("receivePeerMessage",(function(e,o){var r=o.messageList,n=o.fromConversationID;if(n==t.toUid){var i={uid:n};(0,a.getUserInfo)(i).then((function(e){for(var o=0;o<r.length;o++){var n={};n.sendId=r[o].fromConversationID,n.content=r[o].message,n.username=e.data.username,n.avatar=e.data.avatar,t.dataList.push(n)}}))}})),u.on("tokenWillExpire",(function(e,t){t.second;var o={userId:this.userInfo.id};(0,i.getZimToken)(o).then((function(t){var o=t.data.data;e.renewToken(o).then((function(e){e.token})).catch((function(e){}))})),user.getZimToken(this.userInfo.id).then((function(t){var o=t.data.data;e.renewToken(o).then((function(e){e.token})).catch((function(e){}))}))}))},send:function(){var t=this;e.log("发送",t.toUid);var o=t.toUid,r={type:1,message:t.recordInput,extendedData:"1"};u.sendMessage(r,o,0,{priority:1},{onMessageAttached:function(e){}}).then((function(o){var r=o.message;e.log("发送成功");var n={};n.sendId=r.senderUserID,n.acceptId=r.conversationID,n.content=r.message,(0,i.addChatRecord)(n).then((function(e){var o={};o.sendId=r.senderUserID,o.avatar=t.userInfo.avatar,o.content=r.message,t.dataList.push(o),t.recordInput="",t.scrollTop=t.scrollTop+t.itemAverageHeight}))})).catch((function(e){}))},getList:function(){var e=this,t={sendUid:this.userInfo.id,acceptUid:this.toUid};(0,i.getChatRecord)(this.page,this.limit,t).then((function(t){e.dataList=t.data.records.reverse(),e.total=t.data.total,e.scrollTop=e.scrollTop+e.dataList.length*e.itemAverageHeight}))},focusTextarea:function(e){this.inputBottom=e.detail.height,this.scrollTop+=1},blurTextarea:function(e){this.inputBottom=0,this.scrollTop+=1},onRefresh:function(){var e=this;if(this.triggered=!0,setTimeout((function(){e.triggered=!1}),1e3),this.page=this.page+1,!(this.dataList.length>=this.total)){var t={sendUid:this.userInfo.id,acceptUid:this.toUid};(0,i.getChatRecord)(this.page,this.limit,t).then((function(t){var o;(o=e.dataList).unshift.apply(o,(0,n.default)(t.data.records.reverse()))}))}}}};t.default=l}).call(this,o("ba7c")["default"])},a83a:function(e,t,o){"use strict";var r;o("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.ZIMErrorCode=void 0,t.ZIMErrorCode=r,function(e){e[e["Success"]=0]="Success",e[e["Failed"]=1]="Failed",e[e["CommonModuleParamInvalid"]=6000001]="CommonModuleParamInvalid",e[e["CommonModuleNotInit"]=6000002]="CommonModuleNotInit",e[e["CommonModuleInvalidAppID"]=6000003]="CommonModuleInvalidAppID",e[e["CommonModuleTriggerSDKFrequencyLimit"]=6000004]="CommonModuleTriggerSDKFrequencyLimit",e[e["CommonModuleTriggerServerFrequencyLimit"]=6000005]="CommonModuleTriggerServerFrequencyLimit",e[e["CommonModuleSwitchServerError"]=6000006]="CommonModuleSwitchServerError",e[e["CommonModuleIMServerError"]=6000007]="CommonModuleIMServerError",e[e["CommonModuleIMDatabaseError"]=6000008]="CommonModuleIMDatabaseError",e[e["CommonModuleIMServerDisconnect"]=6000009]="CommonModuleIMServerDisconnect",e[e["CommonModuleUploadLogError"]=6000010]="CommonModuleUploadLogError",e[e["CommonModuleUserIsNotExist"]=6000011]="CommonModuleUserIsNotExist",e[e["NetworkModuleCommonError"]=6000101]="NetworkModuleCommonError",e[e["NetworkModuleServerError"]=6000102]="NetworkModuleServerError",e[e["NetworkModuleTokenInvalid"]=6000103]="NetworkModuleTokenInvalid",e[e["NetworkModuleNetworkError"]=6000104]="NetworkModuleNetworkError",e[e["NetworkModuleTokenExpired"]=6000106]="NetworkModuleTokenExpired",e[e["NetworkModuleTokenVersionError"]=6000107]="NetworkModuleTokenVersionError",e[e["NetworkModuleTokenTimeIsTooShort"]=6000108]="NetworkModuleTokenTimeIsTooShort",e[e["NetworkModuleUserHasAlreadyLogged"]=6000111]="NetworkModuleUserHasAlreadyLogged",e[e["NetworkModuleUserIsNotLogged"]=6000121]="NetworkModuleUserIsNotLogged",e[e["MessageModuleCommonError"]=6000201]="MessageModuleCommonError",e[e["MessageModuleServerError"]=6000202]="MessageModuleServerError",e[e["MessageModuleSendMessageFailed"]=6000203]="MessageModuleSendMessageFailed",e[e["MessageModuleTargetDoesNotExist"]=6000204]="MessageModuleTargetDoesNotExist",e[e["MessageModuleCallError"]=6000270]="MessageModuleCallError",e[e["MessageModuleCancelCallError"]=6000271]="MessageModuleCancelCallError",e[e["MessageModuleCallServerError"]=6000272]="MessageModuleCallServerError",e[e["MessageModuleIsNotInvitor"]=6000273]="MessageModuleIsNotInvitor",e[e["MessageModuleIsNotInvitee"]=6000274]="MessageModuleIsNotInvitee",e[e["MessageModuleCallAlreadyExists"]=6000275]="MessageModuleCallAlreadyExists",e[e["MessageModuleCallDoesNotExist"]=6000276]="MessageModuleCallDoesNotExist",e[e["MessageModuleAuditRejected"]=6000221]="MessageModuleAuditRejected",e[e["MessageModuleAuditFailed"]=6000222]="MessageModuleAuditFailed",e[e["ConversationModuleCommonError"]=6000601]="ConversationModuleCommonError",e[e["ConversationModuleServerError"]=6000602]="ConversationModuleServerError",e[e["ConversationModuleConversationDoesNotExist"]=6000603]="ConversationModuleConversationDoesNotExist",e[e["RoomModuleCommonError"]=6000301]="RoomModuleCommonError",e[e["RoomModuleServerError"]=6000302]="RoomModuleServerError",e[e["RoomModuleCreateRoomError"]=6000303]="RoomModuleCreateRoomError",e[e["RoomModuleJoinRoomError"]=6000304]="RoomModuleJoinRoomError",e[e["RoomModuleLeaveRoomError"]=6000306]="RoomModuleLeaveRoomError",e[e["RoomModuleUserIsNotInTheRoom"]=6000321]="RoomModuleUserIsNotInTheRoom",e[e["RoomModuleTheRoomDoesNotExist"]=6000322]="RoomModuleTheRoomDoesNotExist",e[e["RoomModuleTheRoomAlreadyExists"]=6000323]="RoomModuleTheRoomAlreadyExists",e[e["RoomModuleTheNumberOfExistingRoomsHasReachedLimit"]=6000324]="RoomModuleTheNumberOfExistingRoomsHasReachedLimit",e[e["RoomModuleTheNumberOfJoinedRoomsHasReachedLimit"]=6000325]="RoomModuleTheNumberOfJoinedRoomsHasReachedLimit",e[e["RoomModuleRoomAttributesCommonError"]=6000330]="RoomModuleRoomAttributesCommonError",e[e["RoomModuleRoomAttributesOperationFailedCompletely"]=6000331]="RoomModuleRoomAttributesOperationFailedCompletely",e[e["RoomModuleRoomAttributesQueryFailed"]=6000333]="RoomModuleRoomAttributesQueryFailed",e[e["RoomModuleTheNumberOfRoomAttributesExceedsLimit"]=6000334]="RoomModuleTheNumberOfRoomAttributesExceedsLimit",e[e["RoomModuleTheLengthOfRoomAttributeKeyExceedsLimit"]=6000335]="RoomModuleTheLengthOfRoomAttributeKeyExceedsLimit",e[e["RoomModuleTheLengthOfRoomAttributeValueExceedsLimit"]=6000336]="RoomModuleTheLengthOfRoomAttributeValueExceedsLimit",e[e["RoomModuleTheTotalLengthOfRoomAttributesValueExceedsLimit"]=6000337]="RoomModuleTheTotalLengthOfRoomAttributesValueExceedsLimit",e[e["RoomModuleRoomMemberAttributesCommonError"]=6000350]="RoomModuleRoomMemberAttributesCommonError",e[e["RoomModuleTheTotalLengthOfRoomMemberAttributesExceedsLimit"]=6000351]="RoomModuleTheTotalLengthOfRoomMemberAttributesExceedsLimit",e[e["RoomModuleTheLengthOfRoomMemberAttributesKeyExceedsLimit"]=6000352]="RoomModuleTheLengthOfRoomMemberAttributesKeyExceedsLimit",e[e["RoomModuleTheLengthOfRoomMemberAttributesValueExceedsLimit"]=6000353]="RoomModuleTheLengthOfRoomMemberAttributesValueExceedsLimit",e[e["RoomModuleTheMemberNumberOfRoomMemberAttributesExceedsLimit"]=6000357]="RoomModuleTheMemberNumberOfRoomMemberAttributesExceedsLimit",e[e["GroupModuleCommonError"]=6000501]="GroupModuleCommonError",e[e["GroupModuleServerError"]=6000502]="GroupModuleServerError",e[e["GroupModuleCreateGroupError"]=6000503]="GroupModuleCreateGroupError",e[e["GroupModuleDismissGroupError"]=6000504]="GroupModuleDismissGroupError",e[e["GroupModuleJoinGroupError"]=6000505]="GroupModuleJoinGroupError",e[e["GroupModuleLeaveGroupError"]=6000506]="GroupModuleLeaveGroupError",e[e["GroupModuleKickoutGroupMemberError"]=6000507]="GroupModuleKickoutGroupMemberError",e[e["GroupModuleInviteUserIntoGroupError"]=6000508]="GroupModuleInviteUserIntoGroupError",e[e["GroupModuleTransferOwnerError"]=6000509]="GroupModuleTransferOwnerError",e[e["GroupModuleUpdateGroupInfoError"]=6000510]="GroupModuleUpdateGroupInfoError",e[e["GroupModuleQueryGroupInfoError"]=6000511]="GroupModuleQueryGroupInfoError",e[e["GroupModuleGroupAttributesOperationFailed"]=6000512]="GroupModuleGroupAttributesOperationFailed",e[e["GroupModuleGroupAttributesQueryFailed"]=6000513]="GroupModuleGroupAttributesQueryFailed",e[e["GroupModuleUpdateGroupMemberInfoError"]=6000514]="GroupModuleUpdateGroupMemberInfoError",e[e["GroupModuleQueryGroupMemberInfoError"]=6000515]="GroupModuleQueryGroupMemberInfoError",e[e["GroupModuleQueryGroupListError"]=6000516]="GroupModuleQueryGroupListError",e[e["GroupModuleQueryGroupMemberListError"]=6000517]="GroupModuleQueryGroupMemberListError",e[e["GroupModuleUserIsNotInTheGroup"]=6000521]="GroupModuleUserIsNotInTheGroup",e[e["GroupModuleMemberIsAlreadyInTheGroup"]=6000522]="GroupModuleMemberIsAlreadyInTheGroup",e[e["GroupModuleGroupDoesNotExist"]=6000523]="GroupModuleGroupDoesNotExist",e[e["GroupModuleGroupAlreadyExists"]=6000524]="GroupModuleGroupAlreadyExists",e[e["GroupModuleGroupMemberHasReachedLimit"]=6000525]="GroupModuleGroupMemberHasReachedLimit",e[e["GroupModuleGroupAttributeDoesNotExist"]=6000526]="GroupModuleGroupAttributeDoesNotExist",e[e["GroupModuleTheNumberOfGroupAttributesExceedsLimit"]=6000531]="GroupModuleTheNumberOfGroupAttributesExceedsLimit",e[e["GroupModuleTheLengthOfGroupAttributeKeyExceedsLimit"]=6000532]="GroupModuleTheLengthOfGroupAttributeKeyExceedsLimit",e[e["GroupModuleTheLengthOfGroupAttributeValueExceedsLimit"]=6000533]="GroupModuleTheLengthOfGroupAttributeValueExceedsLimit",e[e["GroupModuleTheTotalLengthOfGroupAttributesValueExceedsLimit"]=6000534]="GroupModuleTheTotalLengthOfGroupAttributesValueExceedsLimit",e[e["GroupModuleNoCorrespondingOperationAuthority"]=6000541]="GroupModuleNoCorrespondingOperationAuthority"}(r||(t.ZIMErrorCode=r={}))},c2a0:function(e,t,o){"use strict";var r=o("3c28"),n=o.n(r);n.a},c510:function(e,t,o){"use strict";o.r(t);var r=o("7aae"),n=o("ee02");for(var i in n)["default"].indexOf(i)<0&&function(e){o.d(t,e,(function(){return n[e]}))}(i);o("c2a0");var a=o("828b"),s=Object(a["a"])(n["default"],r["b"],r["c"],!1,null,"12c8016f",null,!1,r["a"],void 0);t["default"]=s.exports},dd80:function(e,t,o){var r=o("c86c");t=r(!1),t.push([e.i,".container[data-v-12c8016f]{width:100vw;height:100vh;box-sizing:border-box;padding-bottom:52px;display:flex;flex-direction:column}.container .header[data-v-12c8016f]{flex-shrink:0;padding:0 %?40?% %?32?% %?40?%}.container .header .nav[data-v-12c8016f]{display:flex;justify-content:space-between;margin-right:10px}.container .content[data-v-12c8016f]{margin-top:52px;flex-grow:1;overflow:auto;height:90vh}.container .content .message[data-v-12c8016f]{margin:0 %?40?% %?32?%;display:flex;flex-direction:column;align-items:flex-end}.container .content .message .message-content[data-v-12c8016f]{width:auto;max-width:calc(100vw - %?80?%);word-wrap:break-word;box-sizing:border-box;padding:%?32?%;line-height:%?48?%;background:pink;border-radius:%?16?% 0 %?16?% %?16?%}.container .content .message .message-time[data-v-12c8016f]{line-height:%?32?%;margin-top:%?16?%}.container .content .tui-flex-end[data-v-12c8016f]{justify-content:flex-end}.container .content .tui-chat-item[data-v-12c8016f]{width:100%;padding:%?30?% %?30?% 0 %?30?%;box-sizing:border-box;display:flex;position:relative}.container .content .tui-chat-item .tui-chat-box[data-v-12c8016f]{max-width:70%}.container .content .tui-chat-item .tui-chat-box .tui-user-name[data-v-12c8016f]{font-size:%?24?%;color:#999}.container .content .tui-chat-item .tui-chat-box .tui-chat-text[data-v-12c8016f]{width:100%;min-width:%?40?%;padding:%?18?% %?24?%;display:flex;align-items:center;flex-wrap:wrap;word-break:break-all;box-sizing:border-box}.container .content .tui-chat-item .tui-user-avatar[data-v-12c8016f]{width:%?84?%;height:%?84?%;border-radius:50%;flex-shrink:0}.container .content .tui-chat-item .tui-mr[data-v-12c8016f]{margin-right:%?24?%}.container .content .tui-chat-item .tui-ml[data-v-12c8016f]{margin-left:%?24?%}.bottom-textarea[data-v-12c8016f]{position:fixed;bottom:0;left:0;right:0;background-color:#fff;border-top:%?1?% solid #f4f4f4;padding:6px 20px;display:flex;align-items:flex-end}.bottom-textarea .textarea-container[data-v-12c8016f]{flex:1;min-height:%?60?%;background:#f2f2f2;border-radius:%?8?%;box-sizing:border-box;padding:%?20?% %?16?%}.bottom-textarea .textarea-container > uni-textarea[data-v-12c8016f]{max-height:%?250?%;font-size:%?36?%;color:#080808;width:auto}",""]),e.exports=t},ea125:function(e,t,o){"use strict";o("6a54");var r=o("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.ZIMManager=void 0,o("01a2"),o("e39c"),o("bf0f"),o("c9b5"),o("ab80"),o("c1a3"),o("18f7"),o("de6c");var n=r(o("80b1")),i=r(o("efe5")),a=r(o("39d8")),s=o("f699"),u=function(){function e(){(0,n.default)(this,e),(0,a.default)(this,"handle",Symbol())}return(0,i.default)(e,[{key:"getVersion",value:function(){return s.ZIMEngine._callMethod("getVersion")}},{key:"createEngine",value:function(t,o){var r=this.handle;if(!e.engineMap.get(r.toString())){var n=new s.ZIMEngine(r,t,o);return e.engineMap.set(r.toString(),n),n}return null}},{key:"destroyEngine",value:function(t){return t?(e.engineMap.delete(t.handle.toString()),t.uploadingMap.clear(),t.downloadingMap.clear(),e.listeners.clear(),t.destroy()):Promise.reject()}},{key:"setLogConfig",value:function(e){return s.ZIMEngine._callMethod("setLogConfig",e)}},{key:"setCacheConfig",value:function(e){return s.ZIMEngine._callMethod("setCacheConfig",e)}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new e)}}]),e}();t.ZIMManager=u,(0,a.default)(u,"instance",void 0),(0,a.default)(u,"engineMap",new Map),(0,a.default)(u,"listeners",new Map)},ee02:function(e,t,o){"use strict";o.r(t);var r=o("7c93"),n=o.n(r);for(var i in r)["default"].indexOf(i)<0&&function(e){o.d(t,e,(function(){return r[e]}))}(i);t["default"]=n.a},f167:function(e,t,o){"use strict";o("6a54"),o("bf0f"),o("2797"),o("dc8a");var r=o("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0});var n={};t.default=void 0;var i=r(o("077a")),a=o("21a9");Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===a[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}}))}));var s=o("a83a");Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}));var u=o("3b76");Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===u[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}}))}));var l=i.default;t.default=l},f699:function(e,t,o){"use strict";o("6a54");var r=o("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.ZIMEngine=void 0,o("c1a3"),o("bf0f"),o("18f7"),o("de6c"),o("c9b5"),o("ab80"),o("7a76"),o("c223"),o("01a2"),o("e39c");var n=r(o("b7c7")),i=r(o("3471")),a=r(o("80b1")),s=r(o("efe5")),u=r(o("39d8")),l=o("21a9"),d=o("7990"),c=o("3ac0"),g=o("ea125"),m=uni.requireNativePlugin("zego-ZIMUniPlugin_ZIMUniEngine"),v=uni.requireNativePlugin("globalEvent"),M=m.prefix(),p=function(){function e(t,o,r){(0,a.default)(this,e),(0,u.default)(this,"handle",void 0),(0,u.default)(this,"appID",void 0),(0,u.default)(this,"appSign",void 0),(0,u.default)(this,"logger",void 0),(0,u.default)(this,"paramValid",void 0),(0,u.default)(this,"loginUserID",void 0),(0,u.default)(this,"uploadingMap",void 0),(0,u.default)(this,"downloadingMap",void 0),(0,u.default)(this,"messageAttachedMap",void 0),(0,u.default)(this,"eventNameList",void 0),this.handle=t,this.appID=o,this.appSign=r,this.loginUserID="",this.logger=new d.ZIMLogger,this.paramValid=new c.ZIMParamValid(this.logger),this.uploadingMap=new Map,this.downloadingMap=new Map,this.messageAttachedMap=new Map,this.eventNameList=["connectionStateChanged","error","tokenWillExpire","conversationChanged","conversationTotalUnreadMessageCountUpdated","receivePeerMessage","receiveGroupMessage","receiveRoomMessage","roomStateChanged","roomMemberJoined","roomMemberLeft","roomAttributesUpdated","roomAttributesBatchUpdated","roomMemberAttributesUpdated","groupStateChanged","groupNameUpdated","groupAvatarUrlUpdated","groupNoticeUpdated","groupAttributesUpdated","groupMemberStateChanged","groupMemberInfoUpdated","callInvitationReceived","callInvitationCancelled","callInvitationTimeout","callInvitationAccepted","callInvitationRejected","callInviteesAnsweredTimeout","conversationMessageReceiptChanged","messageReceiptChanged","messageRevokeReceived","messageSentStatusChanged"]}return(0,s.default)(e,[{key:"create",value:function(){return e._callMethod("setAdvancedConfig",{handle:this.handle.toString(),key:"zim_cross_platform",value:"uni-app"}),e._callMethod("createEngine",{handle:this.handle.toString(),appID:this.appID,appSign:this.appSign})}},{key:"destroy",value:function(){var t,o=(0,i.default)(this.eventNameList);try{for(o.s();!(t=o.n()).done;){var r=t.value;v.removeEventListener(M+r)}}catch(n){o.e(n)}finally{o.f()}return e._callMethod("destroyEngine",{handle:this.handle.toString()})}},{key:"uploadLog",value:function(){return e._callMethod("uploadLog",{handle:this.handle.toString()})}},{key:"on",value:function(e,t){var o=this;if(!t||"function"!=typeof t)throw new Error("listener must be a function.");var r=function(r){var i=r.handle,a=r.data,s=g.ZIMManager.engineMap.get(i);o.logger.warn([],"JSAPI.emit."+e,a),t.apply(void 0,[s].concat((0,n.default)(a)))},i=g.ZIMManager.listeners.get(e);void 0===i&&(i=new Map,g.ZIMManager.listeners.set(e,i)),i.set(t,r),v.addEventListener(M+e,r),this.logger.warn([],"JSAPI.on."+e)}},{key:"off",value:function(e){v.removeEventListener(M+e),g.ZIMManager.listeners.delete(e)}},{key:"login",value:function(t,o){var r=this.paramValid.login(t);return r?Promise.reject(r):(this.loginUserID=t.userID,e._callMethod("login",{handle:this.handle.toString(),userInfo:t,token:o}))}},{key:"logout",value:function(){return e._callMethod("logout",{handle:this.handle.toString()})}},{key:"renewToken",value:function(t){return e._callMethod("renewToken",{handle:this.handle.toString(),token:t})}},{key:"updateUserName",value:function(t){var o=this.paramValid.validName("userName",t,d.ZIMLogTag.User,d.ZIMLogAction.UpdateUserName);return o?Promise.reject(o):e._callMethod("updateUserName",{handle:this.handle.toString(),userName:t})}},{key:"updateUserAvatarUrl",value:function(t){var o=this.paramValid.validName("userAvatarUrl",t,d.ZIMLogTag.User,d.ZIMLogAction.UpdateUserAvatarUrl);return o?Promise.reject(o):e._callMethod("updateUserAvatarUrl",{handle:this.handle.toString(),userAvatarUrl:t})}},{key:"updateUserExtendedData",value:function(t){var o=this.paramValid.validName("extendedData",t,d.ZIMLogTag.User,d.ZIMLogAction.UpdateUserExtendedData);return o?Promise.reject(o):e._callMethod("updateUserExtendedData",{handle:this.handle.toString(),extendedData:t})}},{key:"queryUsersInfo",value:function(t,o){var r=this.paramValid.queryUsersInfo(t);return r?Promise.reject(r):(o=Object.assign({isQueryFromServer:!1},o),e._callMethod("queryUsersInfo",{handle:this.handle.toString(),userIDs:t,config:o}))}},{key:"queryConversationList",value:function(t){var o=this.paramValid.queryConversationList(t);return o?Promise.reject(o):e._callMethod("queryConversationList",{handle:this.handle.toString(),config:t})}},{key:"deleteConversation",value:function(t,o,r){var n=this.paramValid.validConvIDAndType(t,o,d.ZIMLogAction.DeleteConversation);return n?Promise.reject(n):e._callMethod("deleteConversation",{handle:this.handle.toString(),conversationID:t,conversationType:o,config:r})}},{key:"setConversationNotificationStatus",value:function(t,o,r){var n=this.paramValid.setConversationNotificationStatus(t,o,r);return n?Promise.reject(n):e._callMethod("setConversationNotificationStatus",{handle:this.handle.toString(),status:t,conversationID:o,conversationType:r})}},{key:"clearConversationUnreadMessageCount",value:function(t,o){var r=this.paramValid.validConvIDAndType(t,o,d.ZIMLogAction.ClearConversationUnreadMessageCount);return r?Promise.reject(r):e._callMethod("clearConversationUnreadMessageCount",{handle:this.handle.toString(),conversationID:t,conversationType:o})}},{key:"sendMessage",value:function(e,t,o,r,i){var a=this,s=this.paramValid.sendMessage(e,t,o,r);if(s)return Promise.reject(s);var u=(null===i||void 0===i?void 0:i["onMessageAttached"])||Function.prototype,l=function(e){var t=e.messageAttachedHandle,o=e.data,r=a.messageAttachedMap.get(t);null===r||void 0===r||r.apply(void 0,(0,n.default)(o))},d="messageAttached";v.addEventListener(M+d,l);var c=Symbol(Math.round(1e4*Math.random()));this.messageAttachedMap.set(c.toString(),u);return new Promise((function(n,i){m.callMethod({method:"sendMessage",args:{handle:a.handle.toString(),message:e,conversationID:t,conversationType:o,config:r,messageAttachedHandle:c.toString()}},(function(e){v.removeEventListener(M+d,l),a.messageAttachedMap.delete(c.toString()),n(e)}),(function(e){v.removeEventListener(M+d,l),a.messageAttachedMap.delete(c.toString()),i(e)}))}))}},{key:"sendMediaMessage",value:function(e,t,o,r,i){var a=this,s=this.paramValid.sendMediaMessage(e,t,o,r);if(s)return Promise.reject(s);var u=(null===i||void 0===i?void 0:i["onMediaUploadingProgress"])||Function.prototype,l=(null===i||void 0===i?void 0:i["onMessageAttached"])||Function.prototype,d=function(e){var t=e.progressHandle,o=e.data,r=a.uploadingMap.get(t);null===r||void 0===r||r.apply(void 0,(0,n.default)(o))},c=function(e){var t=e.messageAttachedHandle,o=e.data,r=a.messageAttachedMap.get(t);null===r||void 0===r||r.apply(void 0,(0,n.default)(o))};v.addEventListener(M+"mediaUploadingProgress",d),v.addEventListener(M+"messageAttched",c);var g=Symbol(Math.round(1e4*Math.random())),p=Symbol(Math.round(1e4*Math.random()));this.uploadingMap.set(g.toString(),u),this.messageAttachedMap.set(p.toString(),l);return new Promise((function(n,i){var s=function(){v.removeEventListener(M+"mediaUploadingProgress",d),v.removeEventListener(M+"messageAttched",c),a.uploadingMap.delete(g.toString()),a.uploadingMap.delete(p.toString())};m.callMethod({method:"sendMediaMessage",args:{handle:a.handle.toString(),message:e,toConversationID:t,conversationType:o,config:r,progressHandle:g.toString(),messageAttachedHandle:p.toString()}},(function(e){s(),n(e)}),(function(e){s(),i(e)}))}))}},{key:"deleteMessages",value:function(t,o,r,n){n=Object.assign({isAlsoDeleteServerMessage:!0},n);var i=this.paramValid.deleteMessages(t,o,r,n);return i?Promise.reject(i):e._callMethod("deleteMessages",{handle:this.handle.toString(),messageList:t,conversationID:o,conversationType:r,config:n})}},{key:"deleteAllMessage",value:function(t,o,r){var n=this.paramValid.validConvIDAndType(t,o,d.ZIMLogAction.DeleteAllMessage);return n?Promise.reject(n):(r=Object.assign({isAlsoDeleteServerMessage:!0},r),e._callMethod("deleteAllMessage",{handle:this.handle.toString(),conversationID:t,conversationType:o,config:r}))}},{key:"insertMessageToLocalDB",value:function(t,o,r,n){var i=this.paramValid.insertMessageToLocalDB(t,o,r,n);return i?Promise.reject(i):e._callMethod("insertMessageToLocalDB",{handle:this.handle.toString(),message:t,conversationID:o,conversationType:r,senderUserID:n})}},{key:"sendConversationMessageReceiptRead",value:function(t,o){var r=this.paramValid.sendConversationMessageReceiptRead(t,o);return r?Promise.reject(r):e._callMethod("sendConversationMessageReceiptRead",{handle:this.handle.toString(),conversationID:t,conversationType:o})}},{key:"sendMessageReceiptsRead",value:function(t,o,r){var n=this.paramValid.sendMessageReceiptsRead(t,o,r);return n?Promise.reject(n):e._callMethod("sendMessageReceiptsRead",{handle:this.handle.toString(),messageList:t,conversationID:o,conversationType:r})}},{key:"queryMessageReceiptsInfo",value:function(t,o,r){var n=this.paramValid.queryMessageReceiptsInfo(t,o,r);return n?Promise.reject(n):e._callMethod("queryMessageReceiptsInfo",{handle:this.handle.toString(),messageList:t,conversationID:o,conversationType:r})}},{key:"queryGroupMessageReceiptMemberList",value:function(t,o,r,n){var i=this.paramValid.queryGroupMessageReceiptMemberList(t,o,r,n,this.loginUserID);return i?Promise.reject(i):r.count<1||t.direction==l.ZIMMessageDirection.Receive?Promise.resolve({groupID:o,nextFlag:0,userList:[]}):e._callMethod("queryGroupMessageReceiptMemberList",{handle:this.handle.toString(),message:t,groupID:o,config:r,read:n})}},{key:"revokeMessage",value:function(t,o){var r=this.paramValid.revokeMessage(t,this.loginUserID);return r?Promise.reject(r):e._callMethod("revokeMessage",{handle:this.handle.toString(),message:t,config:o})}},{key:"queryHistoryMessage",value:function(t,o,r){var n=this.paramValid.queryHistoryMessage(t,o,r);return n?Promise.reject(n):r.count<1?Promise.resolve({conversationID:t,conversationType:o,messageList:[]}):e._callMethod("queryHistoryMessage",{handle:this.handle.toString(),conversationID:t,conversationType:o,config:r})}},{key:"downloadMediaFile",value:function(e,t,o){var r=this,i=this.paramValid.downloadMediaFile(e,t);if(i)return Promise.reject(i);var a=function(e){var t=e.progressHandle,o=e.data,i=r.downloadingMap.get(t);null===i||void 0===i||i.apply(void 0,(0,n.default)(o))},s="mediaDownloadingProgress";v.addEventListener(M+s,a);var u=Symbol(Math.round(1e4*Math.random()));this.downloadingMap.set(u.toString(),o);return new Promise((function(o,n){m.callMethod({method:"downloadMediaFile",args:{handle:r.handle.toString(),message:e,fileType:t,progressHandle:u.toString()}},(function(e){v.removeEventListener(M+s,a),r.downloadingMap.delete(u.toString()),o(e)}),(function(e){v.removeEventListener(M+s,a),r.downloadingMap.delete(u.toString()),n(e)}))}))}},{key:"createRoom",value:function(t,o){var r=this.paramValid.createRoom(t,o);return r?Promise.reject(r):e._callMethod("createRoom",{handle:this.handle.toString(),roomInfo:t,config:o})}},{key:"enterRoom",value:function(t,o){var r=this.paramValid.createRoom(t,o,!0);return r?Promise.reject(r):e._callMethod("enterRoom",{handle:this.handle.toString(),roomInfo:t,config:o})}},{key:"joinRoom",value:function(t){var o=this.paramValid.validID("roomID",t,d.ZIMLogTag.Room,d.ZIMLogAction.JoinRoom);return o?Promise.reject(o):e._callMethod("joinRoom",{handle:this.handle.toString(),roomID:t})}},{key:"leaveRoom",value:function(t){var o=this.paramValid.validID("roomID",t,d.ZIMLogTag.Room,d.ZIMLogAction.LeaveRoom);return o?Promise.reject(o):e._callMethod("leaveRoom",{handle:this.handle.toString(),roomID:t})}},{key:"queryRoomMemberList",value:function(t,o){var r=this.paramValid.queryRoomMemberList(t,o);return r?Promise.reject(r):e._callMethod("queryRoomMemberList",{handle:this.handle.toString(),roomID:t,config:o})}},{key:"queryRoomOnlineMemberCount",value:function(t){var o=this.paramValid.validID("roomID",t,d.ZIMLogTag.Room,d.ZIMLogAction.QueryRoomOnlineMemberCount);return o?Promise.reject(o):e._callMethod("queryRoomOnlineMemberCount",{handle:this.handle.toString(),roomID:t})}},{key:"queryRoomAllAttributes",value:function(t){var o=this.paramValid.validID("roomID",t,d.ZIMLogTag.Room,d.ZIMLogAction.QueryRoomAllAttributes);return o?Promise.reject(o):e._callMethod("queryRoomAllAttributes",{handle:this.handle.toString(),roomID:t})}},{key:"setRoomAttributes",value:function(t,o,r){var n=this.paramValid.setRoomAttributes(t,o);return n?Promise.reject(n):e._callMethod("setRoomAttributes",{handle:this.handle.toString(),roomAttributes:t,roomID:o,config:r})}},{key:"deleteRoomAttributes",value:function(t,o,r){var n=this.paramValid.deleteRoomAttributes(t,o);return n?Promise.reject(n):e._callMethod("deleteRoomAttributes",{handle:this.handle.toString(),keys:t,roomID:o,config:r})}},{key:"beginRoomAttributesBatchOperation",value:function(t,o){return e._callMethod("beginRoomAttributesBatchOperation",{handle:this.handle.toString(),roomID:t,config:o})}},{key:"endRoomAttributesBatchOperation",value:function(t){var o=this.paramValid.validID("roomID",t,d.ZIMLogTag.Room,d.ZIMLogAction.EndRoomAttributesBatchOperation);return o?Promise.reject(o):e._callMethod("endRoomAttributesBatchOperation",{handle:this.handle.toString(),roomID:t})}},{key:"setRoomMembersAttributes",value:function(t,o,r,n){var i=this.paramValid.setRoomMembersAttributes(t,o,r);return i?Promise.reject(i):e._callMethod("setRoomMembersAttributes",{handle:this.handle.toString(),attributes:t,userIDs:o,roomID:r,config:n})}},{key:"queryRoomMembersAttributes",value:function(t,o){var r=this.paramValid.queryRoomMembersAttributes(t,o);return r?Promise.reject(r):e._callMethod("queryRoomMembersAttributes",{handle:this.handle.toString(),userIDs:t,roomID:o})}},{key:"queryRoomMemberAttributesList",value:function(t,o){var r=this.paramValid.validID("roomID",t,d.ZIMLogTag.Room,d.ZIMLogAction.QueryRoomMemberAttributesList);return r?Promise.reject(r):e._callMethod("queryRoomMemberAttributesList",{handle:this.handle.toString(),roomID:t,config:o})}},{key:"createGroup",value:function(t,o,r){t=Object.assign({groupID:"",groupName:"",groupAvatarUrl:""},t),r=Object.assign({groupAttributes:{},groupNotice:""},r);var n=this.paramValid.createGroup(t,o,r);return n?Promise.reject(n):e._callMethod("createGroup",{handle:this.handle.toString(),groupInfo:t,userIDs:o,config:r})}},{key:"joinGroup",value:function(t){var o=this.paramValid.validID("groupID",t,d.ZIMLogTag.Group,d.ZIMLogAction.JoinGroup);return o?Promise.reject(o):e._callMethod("joinGroup",{handle:this.handle.toString(),groupID:t})}},{key:"leaveGroup",value:function(t){var o=this.paramValid.validID("groupID",t,d.ZIMLogTag.Group,d.ZIMLogAction.LeaveGroup);return o?Promise.reject(o):e._callMethod("leaveGroup",{handle:this.handle.toString(),groupID:t})}},{key:"dismissGroup",value:function(t){var o=this.paramValid.validID("groupID",t,d.ZIMLogTag.Group,d.ZIMLogAction.DismissGroup);return o?Promise.reject(o):e._callMethod("dismissGroup",{handle:this.handle.toString(),groupID:t})}},{key:"queryGroupList",value:function(){return e._callMethod("queryGroupList",{handle:this.handle.toString()})}},{key:"updateGroupNotice",value:function(t,o){var r=this.paramValid.validIDAndName("groupID",o,"groupNotice",t,d.ZIMLogTag.Group,d.ZIMLogAction.UpdateGroupNotice);return r?Promise.reject(r):e._callMethod("updateGroupNotice",{handle:this.handle.toString(),groupNotice:t,groupID:o})}},{key:"updateGroupName",value:function(t,o){var r=this.paramValid.validIDAndName("groupID",o,"groupName",t,d.ZIMLogTag.Group,d.ZIMLogAction.UpdateGroupName);return r?Promise.reject(r):e._callMethod("updateGroupName",{handle:this.handle.toString(),groupName:t,groupID:o})}},{key:"updateGroupAvatarUrl",value:function(t,o){var r=this.paramValid.validIDAndName("groupID",o,"groupAvatarUrl",t,d.ZIMLogTag.Group,d.ZIMLogAction.UpdateGroupAvatarUrl);return r?Promise.reject(r):e._callMethod("updateGroupAvatarUrl",{handle:this.handle.toString(),groupAvatarUrl:t,groupID:o})}},{key:"queryGroupInfo",value:function(t){var o=this.paramValid.validID("groupID",t,d.ZIMLogTag.Group,d.ZIMLogAction.QueryGroupInfo);return o?Promise.reject(o):e._callMethod("queryGroupInfo",{handle:this.handle.toString(),groupID:t})}},{key:"setGroupAttributes",value:function(t,o){var r=this.paramValid.setGroupAttributes(t,o);return r?Promise.reject(r):e._callMethod("setGroupAttributes",{handle:this.handle.toString(),groupAttributes:t,groupID:o})}},{key:"deleteGroupAttributes",value:function(t,o){var r=this.paramValid.deleteGroupAttributes(t,o);return r?Promise.reject(r):e._callMethod("deleteGroupAttributes",{handle:this.handle.toString(),keys:t,groupID:o})}},{key:"queryGroupAttributes",value:function(t,o){var r=this.paramValid.queryGroupAttributes(o,t);return r?Promise.reject(r):e._callMethod("queryGroupAttributes",{handle:this.handle.toString(),keys:t,groupID:o})}},{key:"queryGroupAllAttributes",value:function(t){var o=this.paramValid.queryGroupAttributes(t);return o?Promise.reject(o):e._callMethod("queryGroupAllAttributes",{handle:this.handle.toString(),groupID:t})}},{key:"setGroupMemberNickname",value:function(t,o,r){var n=this.paramValid.setGroupMemberNickname(t,o,r);return n?Promise.reject(n):e._callMethod("setGroupMemberNickname",{handle:this.handle.toString(),nickname:t,forUserID:o,groupID:r})}},{key:"setGroupMemberRole",value:function(t,o,r){var n=this.paramValid.setGroupMemberRole(t,o,r);return n?Promise.reject(n):e._callMethod("setGroupMemberRole",{handle:this.handle.toString(),role:t,forUserID:o,groupID:r})}},{key:"transferGroupOwner",value:function(t,o){var r=this.paramValid.validTwoID("toUserID",t,"groupID",o,d.ZIMLogTag.Group,d.ZIMLogAction.TransferGroupOwner);return r?Promise.reject(r):e._callMethod("transferGroupOwner",{handle:this.handle.toString(),toUserID:t,groupID:o})}},{key:"queryGroupMemberInfo",value:function(t,o){var r=this.paramValid.validTwoID("userID",t,"groupID",o,d.ZIMLogTag.Group,d.ZIMLogAction.QueryGroupMemberInfo);return r?Promise.reject(r):e._callMethod("queryGroupMemberInfo",{handle:this.handle.toString(),userID:t,groupID:o})}},{key:"inviteUsersIntoGroup",value:function(t,o){var r=this.paramValid.validGroupUserIDs(t,o,d.ZIMLogAction.InviteUsersIntoGroup);return r?Promise.reject(r):e._callMethod("inviteUsersIntoGroup",{handle:this.handle.toString(),userIDs:t,groupID:o})}},{key:"kickGroupMembers",value:function(t,o){var r=this.paramValid.validGroupUserIDs(t,o,d.ZIMLogAction.KickGroupMembers);return r?Promise.reject(r):e._callMethod("kickGroupMembers",{handle:this.handle.toString(),userIDs:t,groupID:o})}},{key:"queryGroupMemberList",value:function(t,o){o=Object.assign({count:100,nextFlag:0},o);var r=this.paramValid.validID("groupID",t,d.ZIMLogTag.Group,d.ZIMLogAction.QueryGroupMemberList);return r?Promise.reject(r):o.count<1?Promise.resolve({groupID:t,userList:[],nextFlag:o.nextFlag}):e._callMethod("queryGroupMemberList",{handle:this.handle.toString(),groupID:t,config:o})}},{key:"queryGroupMemberCount",value:function(t){var o=this.paramValid.validID("groupID",t,d.ZIMLogTag.Group,d.ZIMLogAction.QueryGroupMemberCount);return o?Promise.reject(o):e._callMethod("queryGroupMemberCount",{handle:this.handle.toString(),groupID:t})}},{key:"callInvite",value:function(t,o){var r=this.paramValid.callInvite(t,o);return r?Promise.reject(r):e._callMethod("callInvite",{handle:this.handle.toString(),invitees:t,config:o})}},{key:"callCancel",value:function(t,o,r){var n=this.paramValid.callCancel(t,o);return n?Promise.reject(n):e._callMethod("callCancel",{handle:this.handle.toString(),invitees:t,callID:o,config:r})}},{key:"callAccept",value:function(t,o){var r=this.paramValid.validID("callID",t,d.ZIMLogTag.Call,d.ZIMLogAction.CallAccept);return r?Promise.reject(r):e._callMethod("callAccept",{handle:this.handle.toString(),callID:t,config:o})}},{key:"callReject",value:function(t,o){var r=this.paramValid.validID("callID",t,d.ZIMLogTag.Call,d.ZIMLogAction.CallReject);return r?Promise.reject(r):e._callMethod("callReject",{handle:this.handle.toString(),callID:t,config:o})}}],[{key:"_callMethod",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(o,r){m.callMethod({method:e,args:t},(function(e){o(e)}),(function(e){r(e)}))}))}}]),e}();t.ZIMEngine=p}}]);