<view data-event-opts="{{[['contextmenu',[['',['$event']]]]]}}" class="chatInterface data-v-cd130814" bindcontextmenu="__e"><tui-navigation-bar vue-id="d54cf860-1" backgroundColor="#fff" isFixed="{{true}}" isOpacity="{{false}}" class="data-v-cd130814" bind:__l="__l" vue-slots="{{['default']}}"><view class="nav data-v-cd130814"><tui-icon vue-id="{{('d54cf860-2')+','+('d54cf860-1')}}" name="arrowleft" size="25" class="data-v-cd130814" bind:__l="__l"></tui-icon><block wx:if="{{friend}}"><view class="username data-v-cd130814">{{friend.username}}</view></block><tui-icon vue-id="{{('d54cf860-3')+','+('d54cf860-1')}}" name="more-fill" size="22" class="data-v-cd130814" bind:__l="__l"></tui-icon></view></tui-navigation-bar><view class="scroll-view data-v-cd130814"><block wx:if="{{history.loading}}"><image class="history-loaded data-v-cd130814" src="../../../static/images/chat/loading.svg"></image></block><block wx:else><view data-event-opts="{{[['tap',[['loadHistoryMessage',[false]]]]]}}" class="{{['data-v-cd130814',history.allLoaded?'history-loaded':'load']}}" bindtap="__e"><view class="data-v-cd130814">{{history.allLoaded?'无更多的历史消息':'获取历史消息'}}</view></view></block><checkbox-group data-event-opts="{{[['change',[['selectMessages',['$event']]]]]}}" bindchange="__e" class="data-v-cd130814"><block wx:for="{{$root.l0}}" wx:for-item="message" wx:for-index="index" wx:key="messageId"><view class="data-v-cd130814"><view class="time-lag data-v-cd130814">{{''+message.m0+''}}</view><block wx:if="{{message.$orig.recalled}}"><view class="message-recalled data-v-cd130814"><block wx:if="{{message.$orig.recaller.id===currentUser.id}}"><view class="message-recalled-self data-v-cd130814"><view class="data-v-cd130814">你撤回了一条消息</view><block wx:if="{{message.g0}}"><label data-event-opts="{{[['tap',[['editRecalledMessage',['$0'],[[['history.messages','messageId',message.$orig.messageId,'payload.text']]]]]]]}}" bindtap="__e" class="_span data-v-cd130814">重新编辑</label></block></view></block><block wx:else><view class="data-v-cd130814">{{message.$orig.recaller.data.name+"撤回了一条消息"}}</view></block></view></block><block wx:else><view class="message-item data-v-cd130814"><view class="message-item-checkbox data-v-cd130814"><checkbox hidden="{{!(messageSelector.visible&&message.$orig.status!=='sending')}}" value="{{message.$orig.messageId}}" checked="{{message.g1}}" class="data-v-cd130814"></checkbox></view><view class="{{['message-item-content','data-v-cd130814',(message.$orig.senderId===currentUser.id)?'self':'']}}"><view class="avatar data-v-cd130814"><image style="width:80rpx;height:80rpx;border-radius:50%;" src="{{message.$orig.senderId===currentUser.id?currentUser.avatar:friend.avatar}}" mode="aspectFill" class="data-v-cd130814"></image></view><view data-event-opts="{{[['contextmenu',[['showActionPopup',['$0'],[[['history.messages','messageId',message.$orig.messageId]]]]]],['longpress',[['showActionPopup',['$0'],[[['history.messages','messageId',message.$orig.messageId]]]]]]]}}" class="content data-v-cd130814" bindcontextmenu="__e" bindlongpress="__e"><view class="message-payload data-v-cd130814"><block wx:if="{{message.$orig.status==='sending'}}"><view class="pending _b data-v-cd130814"></view></block><block wx:if="{{message.$orig.status==='fail'}}"><view class="send-fail _b data-v-cd130814"></view></block><block wx:if="{{message.$orig.type==='text'}}"><view class="{{['data-v-cd130814',message.$orig.senderId===currentUser.id?'text':'text-friend']}}"><rich-text nodes="{{message.m1}}"></rich-text></view></block><block wx:if="{{message.$orig.type==='image'}}"><image class="image-content data-v-cd130814" data-url="{{message.$orig.payload.url}}" src="{{message.$orig.payload.thumbnail}}" mode="heightFix" data-event-opts="{{[['tap',[['showImageFullScreen',['$event']]]]]}}" bindtap="__e"></image></block><block wx:if="{{message.$orig.type==='video'}}"><view class="video-snapshot data-v-cd130814" data-url="{{message.$orig.payload.video.url}}" data-event-opts="{{[['tap',[['playVideo',['$event']]]]]}}" bindtap="__e"><image style="{{'height:'+(message.m2+'rpx')+';'}}" src="{{message.$orig.payload.thumbnail.url}}" mode="heightFix" class="data-v-cd130814"></image><view class="video-play-icon data-v-cd130814"></view></view></block><block wx:if="{{message.$orig.type==='file'}}"><view class="file-content data-v-cd130814"><view class="file-info data-v-cd130814"><label class="file-name _span data-v-cd130814">{{message.$orig.payload.name}}</label><label class="file-size _span data-v-cd130814">{{message.g2+"KB"}}</label></view><image class="file-img data-v-cd130814" src="../../../static/images/chat/file-icon.png"></image></view></block><block wx:if="{{message.$orig.type==='audio'}}"><view data-event-opts="{{[['tap',[['playAudio',['$0'],[[['history.messages','messageId',message.$orig.messageId]]]]]]]}}" class="audio-content data-v-cd130814" bindtap="__e"><view class="audio-facade data-v-cd130814" style="{{'width:'+(message.g3*7+50+'px')+';'}}"><view class="{{['audio-facade-bg','data-v-cd130814',(audioPlayer.playingMessage&&audioPlayer.playingMessage.messageId===message.$orig.messageId)?'play-icon':'']}}"></view><view class="data-v-cd130814">{{message.g4}}<label class="_span data-v-cd130814">"</label></view></view></view></block></view><block wx:if="{{message.$orig.senderId===currentUser.id}}"><view class="{{['data-v-cd130814',message.$orig.read?'message-read':'message-unread']}}"><block wx:if="{{message.$orig.status==='success'}}"><view class="data-v-cd130814">{{message.$orig.read?'已读':'未读'}}</view></block></view></block></view></view></view></block></view></block></checkbox-group></view><block wx:if="{{!videoPlayer.visible&&!messageSelector.visible}}"><view class="action-box data-v-cd130814"><view class="action-top data-v-cd130814"><view data-event-opts="{{[['tap',[['switchAudioKeyboard',['$event']]]]]}}" bindtap="__e" class="data-v-cd130814"><block wx:if="{{audio.visible}}"><image class="more data-v-cd130814" src="../../../static/images/chat/jianpan.png"></image></block><block wx:else><image class="more data-v-cd130814" src="../../../static/images/chat/audio.png"></image></block></view><block wx:if="{{audio.visible}}"><view data-event-opts="{{[['tap',[['onRecordStart',['$event']]]],['touchend',[['onRecordEnd',['$event']]]],['touchstart',[['onRecordStart',['$event']]]]]}}" class="record-input data-v-cd130814" bindtap="__e" catchtouchend="__e" catchtouchstart="__e">{{''+(audio.recording?'松开发送':'按住录音')+''}}</view></block><block wx:else><input class="consult-input data-v-cd130814" maxlength="700" placeholder="发送消息" type="text" data-event-opts="{{[['confirm',[['sendTextMessage',['$event']]]],['input',[['__set_model',['','text','$event',[]]]]]]}}" value="{{text}}" bindconfirm="__e" bindinput="__e"/></block><view data-event-opts="{{[['tap',[['switchEmojiKeyboard',['$event']]]]]}}" bindtap="__e" class="data-v-cd130814"><block wx:if="{{emoji.visible}}"><image class="more data-v-cd130814" src="../../../static/images/chat/jianpan.png"></image></block><block wx:else><image class="more data-v-cd130814" src="../../../static/images/chat/emoji.png"></image></block></view><view class="data-v-cd130814"><image class="more data-v-cd130814" src="../../../static/images/chat/more.png" data-event-opts="{{[['tap',[['showOtherTypesMessagePanel']]]]}}" bindtap="__e"></image></view><block wx:if="{{text}}"><view class="send-btn-box data-v-cd130814"><text data-event-opts="{{[['tap',[['sendTextMessage']]]]}}" class="btn data-v-cd130814" bindtap="__e">发送</text></view></block></view><block wx:if="{{emoji.visible}}"><view class="action-bottom action-bottom-emoji data-v-cd130814"><block wx:for="{{$root.l1}}" wx:for-item="emojiItem" wx:for-index="emojiKey" wx:key="$index"><image class="emoji-item data-v-cd130814" src="{{emoji.url+emojiItem.$orig}}" data-event-opts="{{[['tap',[['chooseEmoji',[emojiKey]]]]]}}" bindtap="__e"></image></block></view></block><block wx:if="{{otherTypesMessagePanelVisible}}"><view class="action-bottom data-v-cd130814"><view class="more-icon data-v-cd130814"><image class="operation-icon data-v-cd130814" src="../../../static/images/chat/picture.png" data-event-opts="{{[['tap',[['sendImageMessage']]]]}}" bindtap="__e"></image><view class="operation-title data-v-cd130814">图片</view></view><view class="more-icon data-v-cd130814"><image class="operation-icon data-v-cd130814" src="../../../static/images/chat/video.png" data-event-opts="{{[['tap',[['sendVideoMessage']]]]}}" bindtap="__e"></image><view class="operation-title data-v-cd130814">视频</view></view></view></block></view></block><block wx:if="{{actionPopup.visible}}"><view data-event-opts="{{[['touchmove',[['',['$event']]]]]}}" class="action-popup data-v-cd130814" catchtouchmove="__e"><view class="layer data-v-cd130814"></view><view class="action-list data-v-cd130814"><view data-event-opts="{{[['tap',[['deleteSingleMessage',['$event']]]]]}}" class="action-item data-v-cd130814" bindtap="__e">删除</view><block wx:if="{{actionPopup.recallable}}"><view data-event-opts="{{[['tap',[['recallMessage',['$event']]]]]}}" class="action-item data-v-cd130814" bindtap="__e">撤回</view></block><view data-event-opts="{{[['tap',[['showCheckBox',['$event']]]]]}}" class="action-item data-v-cd130814" bindtap="__e">多选</view><view data-event-opts="{{[['tap',[['hideActionPopup',['$event']]]]]}}" class="action-item data-v-cd130814" bindtap="__e">取消</view></view></view></block><block wx:if="{{messageSelector.visible}}"><view class="messageSelector-box data-v-cd130814"><image class="messageSelector-btn data-v-cd130814" src="../../../static/images/chat/delete.png" data-event-opts="{{[['tap',[['deleteMultipleMessages',['$event']]]]]}}" bindtap="__e"></image></view></block><block wx:if="{{audio.recording}}"><view class="record-loading data-v-cd130814"></view></block><block wx:if="{{videoPlayer.visible}}"><video src="{{videoPlayer.url}}" id="videoPlayer" data-event-opts="{{[['fullscreenchange',[['onVideoFullScreenChange',['$event']]]]]}}" bindfullscreenchange="__e" class="data-v-cd130814"></video></block></view>